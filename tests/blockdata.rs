// Rust Monero Library
// Written in 2019-2022 by
//   Monero Rust Contributors
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in all
// copies or substantial portions of the Software.
//

use monero::blockdata::transaction::{
    ExtraField, Transaction, TransactionPrefix, TxIn, TxOut, TxOutTarget,
};
use monero::consensus::encode::{deserialize, serialize, VarInt};
use monero::cryptonote::hash::Hashable;
use monero::util::key::PublicKey;
use std::str::FromStr;

// Rct type 0
#[test]
fn deserialize_transaction_1() {
    let hex = hex::decode("02810101ff4501a39dc2dffbff0302f375e57dc7d543759121fc7acaddfa764887c09258086bc5d80d9405b257eda42b013291a7a0083b9ce980ebbf7f14a5aa2d2059b38cee3821d9e841ce727bcff60702080000001fb2c5940000").unwrap();
    let tx = deserialize::<Transaction>(&hex[..]);
    assert!(tx.is_ok());
    let tx = tx.unwrap();
    assert_eq!(hex, serialize(&tx));
    assert_eq!(
        "980cf52becc017dc7dff0e8e6e37b2819e0b8976e6dd7ceebf44f8c04bdf2fa7",
        format!("{:02x}", tx.hash())
    );
}

// Rct type 1
#[test]
fn deserialize_transaction_2() {
    let hex = hex::decode("0200010200080044094e36420c184176506a33661ab047966f6f5e87ab83627f5cfb396a9f2968ab4e9268aeb82c02000273b53968fd4f4b4aad0d9af2913c160689920a0b5fe4defab332e8c79a2f9e190002c054278471c800229b52945e2c529ffa14c8cbb4a80e7dea052a306d5d7a12c421012d6c835764aaf4a10dcfaa509fbcbba75370da59e952cad60b8597b2a925bef0018088e2ed60f8ac972ca61e846b7ea0d80d832ae200f88e2faf93d9a7d5e6f5825ef974880980ea3a2efa8b7bf92f338aefa971adfd860d7347f8adc72c04b5c200af601e0dabd8f8e851f7968a5fb7cbdf860967296135ff67792a4e03127807327d7996080b96ae99c87924f23b25bbb2d87c6aa0ec10b400ef29b5aedd38e7b98517680cd4f1a7777df8738f07a20b520cfbb1bc6377cb3ff0257d2305377f2be6deecd45a06dada2ec87950dc1678da9fbd71f20596a069557295e2291648ca003d0a4837eac0de43f3fc96b0238dcc66dfc4e46177ac89d5d949d3e46c5a1fa7a9a2021553300eedcc0729030b43ed8681b824f70285815db4aa62213fb2d92d952801b63b46126a8dea3541a28b0332951b657912db05bd15efaef1b78993f981e00a84dfc7b23c2e51e36e360d8477532971c4b8def5f55809e3f2597258ffb4bf0ad936db848489b275568e9d093af08f26af9a5421a2ab9d461cc7e3aa286bd3021309edde918cb49a5d0d49e0db8ec6f5835409436776b7cae481dcbc34f7ff099de621571195b9937be4522a6cb81d962057d6045fddc96a9fc74a6363de260e945d930b31fe3bc745714c1e0142afe62e8ab123adab342ad8cadac8707b100e1830cb1d7ba045743bc2ed3a5f89964e6571354a11d926a76074c52e6789be0a29705379f09af4c187d55223ff543048e714b53aa403000f6d8a59dfbdeebc0a5e884950a074aee4ab3198fde8d5e283fc30936d59b3a32bd057c97996203f0e7982430b1ab2e8c70917f63902a7297cdb000d6f4d6d9eb8686fac3cdae1a10714b8ccc178455bdf46aab47316f6ccb6bbdc3e67c4974d1d34c03a107278880ea1c091eed71f17314f8aea6278116b9e3739fab61d363db6f433dd38cd8fdf087d5d4121479e8de76bbc613d4b30aa95b7c7f3e51e7cea41e1b6a478b6aefc072b78a9bb0f95f37a8535f8b45a572bfa71a7dfabcd8af5be2123b4cf2733ce0a3337b098a1cb0e1df3f1416cfe1d1fcf9d29c587982714aeda9a67763e861f0321175972f9ab76b7ebe883f921a6ba261595de514983a5b76b20939c9e273e0012da19f9d9a84d1e25a1f7233286d9194e2a227ad74af2b332e63b5e910d970ff9e4dc64da386f031feee2d5af84a4877956c8cac4f71288807d0340b4ca7c053d8e2cb3a3f58e1ccbfd5daf34d59746254a98478ca781fd7faddd46e911e4004bd1a16bbf6fb48d2cd005a64e10586123cb22c40711dc4a8dbce1c31e49610b0b067f357b7ca8f69ba17d1be4fc90e6df9d39ed4d5e240ee3636a00c7616b059881090bc63bdfbddc4bce45bcb2a8b255ee099984cbcd4993b276e62b07750fcbc59436134ccfbacf837ebdc5bacf62aa2c5ca9c15123fd45ebe16751565106ab4f0e09318a42ef2d14711fac9fe8a2209b7e3192afb973e7b764011b47720e50a6e0bf6d68372615cf7ca68848afa81bee991d46dd2d89d75dd97166a16a0a07dfe6778b5c43172f327586a86a534379afb94de7f3ac400017705c8d462e078a5b746f5fd8c602015d1bfc7ecdb94609da87bf6e2067ca40f437240afdf4018df6e3e036e9eeab7655c761951077ac11c1ff83043399095b448cbc0452d90c339f89b295dfc733bb840b8d764f9923e84bb1dfac11a2bdf22f9f03fa83f80fc73b1cb4fdf73a6db59f4032e38b32b1195dbef03e638747339c998c3249750e9d53638f16923474381996de2e723f9f8886c1882d5705eb8aabc01b9e5720012f7daa38ac48f73286536b7c98569a93c877190540f3cb6d2498e852809d2401cb1a764f451dc926db3eafad87a099218952e4ecaa387cb3aa976cf6f7b2430a2d8247e209c0ab4a2a9ede53f4063d66f91a4e7b668f4f3144548d2cfe237a08b6e44b4bc02d422ebf7eeb4199df5d4328a19fe2084814d282617d39fc7e070ea631a0878dd630fcc3cf48acadc8c250acd769584be9595557d246bd6ecd770c3696bf2c461d9d5f095fa0efa8478acf3b390d1d9f877172b39f818c3083ae089c3e7dc392acf21872e2303b4a76648f9f9012a3d078e02ec60db490da9c470a08cf6202603aa0974c617ff1efeb9827d2e69c932b25af242f673c2a7801bf0232ab4adddbf2f3d4f66c4aea06cf9700a13975c1d49db41d2d73d25069a96a00d5d244a726b9797df2475d7d1af156b2f27b9dabe2bc43ece6fc428447205f04954eaace55e7dd1e1751df010231f27e6d14a2b08fc71fac03786ad88710630a90bb87763af18f468b07b3ca4b1ef21cf7863f0b9c16ed30cc5e3dfaeb1a2b0d70bf9639664a41a920bb9dc09b115f46588828447ca4e3a336d2ee1261dd160301e7b43991b12d966c6084005c1a3e62dc4ad05b6739fa7dfcbb5c70dccde402e974cb5bef5f2cec7f7955c21efe13ea56645cfc0499a5a531c50cf3867f6a08efa481418f935f62059484c373000b9cd16e55570b3189b0e7de8621b9018c0b68c3045ffe2a695522f7316789942a0bf23e878e7be3dce583419eba723d9e0f9a5795c907958daca86c4a002e10af7b6d82ab14b4c3d981f82df51c3cdd0e013211b372840a995aed5b22a779d3192e44c42fdf1131de5841b4263dc3098802d88aacd1f7aa19fd10d712bd6e7a54adbc00dce484de9028d51719e5652cbc047f239a743c5edc37e242340f72dfc82bf573d49b368362af7aafa303c17583087c76f0de9f356fde5ffdc2a8c12453679ee2c47c67d7a567a13e324f33c0be0cc91e315692d863db28f6f654048004c6caa69ec9c230c4ab31f6b03e9d57380b044c6e36aab1964bbad5eed53a6bfe0062d7f2469d72f0b4d36a1f6e093da905ad0dcaad3c6e91de83e9ff22e5be01091b57c16862c623e9bf2b0490b73f5a04fc280a7dc82605cf280efb51a81798f2e76914c7b7f2de8860f091376f5127022c7d87793d829740ebd6249c2c291b4f3e1b1b0eea8d86e712658f19ff05c8032b0d7df6ac2bc7d1766101179ad2e139ebb3b85b0cb7c49a15987784cbe75f054bb73977f75b053b21c8f77cec264f8e730eff9f521c78347d48a76c6c3a2208e523fe7030e0a9f5b06f55edd43dfa717fa72a44fb2782bc749192f30f4e6a0ae679c9eae7b0b75642825dc12e373f01b19a967eb54a9326c7f9ae8b0bae30065e93ffd3dbe2dfa70b3f1e1d699bf3e5985d167d9ff01ad4d584fe7f28327d06c29614042866056628ca9f7ad7fbc4780c5b0749db4e9af408c0697e351a9d04d8ae1073516d741345d3e7161ca34ffe117d6ceb87dc3a2839fc9db758d3330c33473bb5730899dcfe9253d16e1318ceceed7ade514b34f757f7750bacfa1807907c40793766d1f894f0cb69cd8cf696a1b95e29e180338521412368abc8a0023b12e70427e017c075c1b72ef0506e9d5681a16e3c01152398d1835dd6ca010d130509ee9b1f12e442701928467ed4462c5b719d9adf4e663aae363a0c21d3017f28c621d9d2700af2845f48bc8cab27afb9d77b3f5f36e85e01de7200b6b902a23036b9557a011f6c17cd72d45527ed8f2925542dce1a40709cf34db8cabd02682847687c474b8c272996e4b766ed85dfc813d789de4e88d0335dfae647650142f87ebad566abb14cb586d059087d2ad916f8768657380b053331e4d3c9910491d15407b0beb5addfd3e1617f5545077ef11302e437cd0f9861def65704510ef7bd529d9e702115627e48054d2d7586c166493b07764469c0eb31ff7f4d6d0987022e95806799dff25c10a8e7ae57219e42196538d36f51d05e5f025c37c80a870455a62797d8de2435aab1afb2672a7569f997cc82f480f26b894d248b5d009a245aa9497744ab567712703e7cb5d9f23b5e5f3f04149420bfe9e85d18790f75b283342e6e9ece733293e90a35000d6d6a598e04a5d91252ae419af2ed5c000c4b50bb994ce47dabc4cbd25e8b64d44b94330ba9f97a70cfa671e370253b04cdd520d5774bb5320427279aa76292931ae8979380b79daa49236fe496063f04389e99d819b2f931d7796e70ec7be30661780388bf75fd8e2b02d2ae0def8109c2027bc574fddbd3d735594c40a01140e7858ce6ecb3c9835edfba156cef91006d77e8fe29c4ddcbe1ff5b1699ab44338af01061f0fd8dcb2fa6756db03daf06986730a7a2893821c7d46f3ff56e23a162ef5b0a7e87ba1ab8c812b742c2f80a39dd319e3049bc184f94f1ceb25073f68d2f82bc25cc46b50a1411d66b37ed0d0ac1c790459f0da7b11080ed66d9f8f2dbe2ccdb729ca5dc1d85fe97f857ed0721048de205904feb44097d360550aebbf721cc0483365b3cf42cd0449041bf049a931c069f80ec48dda773b29f3f8bec72fa7ec650ddfc7d68f05935c221f304a6d4304f861ea8126275c1442315d3d3b97c1ad5d94cb0b0dd8558ee16b32a0bee44a8a410b3125ed9fb8e22ef5381a9bac9a716418c423b905c172c7c056d02505ae4f3bcc5e9ad6b40ffa8f1943332fb446a7064cea17fea6b5b3e5ddf150de9c833fc7230ad84049f01376d947522615687b8959b9a7947c9ca84c7bc6e08c741c35026a68d57589a69a4622001250b19dc09a2fe9c508934b6394f14ee031935191bba929d2cedcc4a58945a9926b9b3595c5b0ae995fd7560ba39a11d04386862a510ce069fe54415ed0e8df72f60a8910b9f541ac8ae3526db4aa5ac01235a69fb7009a850c26a2f880cac3160dbaec2af34219066955ff5ffcbdba3057af2055ce695a2b71bfa95c8e47fe932d24b5fd035ed5e6f960535c383a6440d6312e1c278b2ead518009638cf7e54e740808ee0ee9adb1eaa5ee8deeaa7cd082c3e2ab16452c1d41515b5d88f04a0c64d6746d83d6b94435ad9c3e3e87b290754feb57b4d762df97e6830fb22eda3417eb261442100d952d98508ae07ef2f0f762afe5ecfcd16d8fc15b67365df7860b279f525b52211ce23361b921c49be04327c51de5cb4480636af42209748dc33290f965f01ac49bab09431a33043f80b0ee789a944abd9e451dec39e3eb490107f796e89e79523ca0806fb2b7b7ca909d009bb933c291f2016792468fb1ae4b3c30c7dac13424c298c672c253f063303f145f31596ad4422c04eb39282b62b712c329f4bb2d4fd1be0de904d1fef0d0a01e964e9ac6f9f8f4be3f259b22a6bfc5e3f478c268d4a65db602dad98f893096fec8c523ddfd39ce2b045237ec4520c5339c3a8bacdbd8d1ee0a52a6995120f798df4d80f0345eb01adbb9e8ce452f95ee580c58346582e321d69fcea895d017b459fc15c94908a1db11fc2aaf9d6d84b675e4c2b0dac8bd46a1325f5c6fa0e4ac570910fc1b15a29f7eb8bf17fee5b703bebb1a1836a78a9842d0942a1da0ff860baf23298380b9ad3d61ef726b2bbbddde7a232089d58e7cc3aeecdc34c077064d481ec19e4fa398e41ef91ccb5fba5415e69a2371334ca07e545e78b2901329f2cf2633eb2164b4accb63c66b0f7ccb492e68e2da5d0806630fd4893040b757a1360c8fbddc43e021365764322770824c6d7c2b8c79b4f7282e1ebddc802346ba3254ea107d52ee0d437691b13021a6e779446e98a25fd1396edf62f2e0e14423f8b3448a5a54a9291ace7af055828d71b6001203ba80cae187626eec70828b1de82dfe1f94ccfcfb320409c7da50f8bb8adf90c61f4a70b618cbce9f2076845f5391d638e46636dcd386ca5262a2d8f55485ce0425819281aa6dafc72083f078284bb98bb95f94a58a02283d576912e645d457ee5cbe2ba07f58e07fa0202990a3716addfe5d5e571b918de9267817a05c2ad0ebe2aff6e152fe0aaf405eff3e660be81527da962036fe2865ac2eefa609204c4894c397621df6f80ec0e169bd7d94c0710bce684d7e76fae15d9956d44e77b263e9ac57b9ab303e33e0cc1f3efc01ccb5931e7c31b298fe52009a7ce6a6a0358c90a8d973fb4c2f27e0aa5189445302a2a05446cc9f739c6b83dc0a0602ea52e6d5b024932e816e5bc02741148f4801499e6c090f387d576bea45bff5c4b6b8dc7c2371964fd9501db04e89c176f12c6a742f203b8c82838389a08e8081e6dd0093d6a1df96c83974309e087794b92bd63fc8466c3abc673f5ff1c6c68d05a3f074961ce2336300b7e72dc7abb33eb6824beb5e8df5138beb7581acdcc9e432235f3db0e52e44d355ba03ff1601839141b6ca0d57707ebc3a0db803b7a3fa40c85e55ad9beb8e4dba222249771696b7881989f4a4e4fb65f363d175e389b986a21114fe05336d78829f99d2aff5e4ab271a522990348e83b9df3edd7405e420cb2509885c5a3c82f41b86dd844e578b406341b071746c9baf669ef0972138c9dc442f0dbbfbda5381e48e3affd45020a1b7ceaec8dfc55fc16591478315cdd59d8889210c19b262574efb5ea81e60f5f75e91ac04b6d1ccdda679292ac6a8f3ebb0f3808e67729839e38949f6e744f916505bc7d09ac87cb6e047a4867ce511329448f6c9abd916871e50a657c2ec174d80eaace74fdb0e504fd284bc1a65c33fc79e5c2b4c66574872e3932802e6a51e8844dd3ba9a21ff8edfaf6ab29a979214dd2a3679dfd126c4944432493404a4f2b6c1a4816e9b39b370300cf47b06ea989abedf6b824122db1b82334b2d1094b2f03ae1802975138598d1f42f84bf3bd5ad1f7a9ce69be9a135d16f574e9601dedc5bbeadff6a0373a556fa6975d1026ce4954d6d9db7604c2e9c9fd9c9cd3c4f123766ab70e3ca99a4ea871017e360b376d81d4e00eb078362ebe780d5fb43541ba69a5ffa99ea388bcfb525efa177f32449be3352b75e14de34ad6a6678abe57af959736f925fc8e8f6755eaca566d4c91a1b76b9ef4536b6addfb9a62670b574532470fd551558107dbb4eac678b1fab44fadc18a123bb68a846c9a9ac11eb4d5ee3a91fbd458edacd44c5ff586e3a7f6a88ff01352a7dbbd5b1189ad898bdfcd5ef1707379d1d64897e29923424589d395d3dd8fa5172fbe910179d2a76833679ebfe0ad13c98cd28cacff804791b6e5aed8f0f6220fcfa18f8ab85255f0471b092f3fc269e08ad3cd65aec7cdeec2e675595258bcc9e500f20d11b16774608f26175dcb9f88b6669b483b1786c162adf4cd18d0314c86c8608cd5d3dc2de33402ae6d941bb8597f75b80acf2aa936579aa5a677cfaacdf801d5cfb3a3e4f2f67be8413f8e447805cc7a9572abce6ce11202fa63ba0ad653a73645ea19644e5a0f58e32da1d6e0761014372eddbfa69364d05d3a075d453eb0186e533590a29e361deedd9c7868397950772ce172b4654ba2893dc7f1b16f212de38270914cc99d0724637c1f7fd745ae10e197813c2c425bd75135d79e78588349e68bee95be6b7808bf0fd81a9ef511d7936862ab85c68b33ccce9238f388d19a3b66a2c0714002460ac0b7a8f2b90731039874c4430e5077462049cb099c21567bd5372bf99b81862cb2b916689cd52421754a6d58f0d13c02f0927d2d57b8ac53a9274ca51d8d5e59bd6dc544f36062107ccea1e1e24874230e6c7b7aa2d6d71c8c1a18a314fd942a23ccedbe8c292c3e2ffe78bf29136c2da5f3a18c356522e0c8d1a829e812d68f7dc48723e4e33cfcdfe689d84cd980b714296ee85ee4fa22030c73f840eedf923a67f2ab22ec6853cb9a4d058a72cb453127e4c80f2d04a532560308f0c8aa6757ecbf406cd0dfaf5181375c6f1794bb7f772baf4a445a34b311be476650821413562624e5f0df0b4a0ecfc3cd666b77dc04ed672aecb5e8283d07eb8c906b60783a9d95822bf38c464461d074936051273c6c9e661d934116a918fa0f7f23b08da7119fd88b95ec031990c14c616e2dc5a3dd400deb8f9e187657ba93473ec614cf057c17e0e5217992af231e61a3fbc083ae461cfb5e9a1a114bea8d86264db37206a56afd3aaba5e6fddf5e42990f01fefb651e11fc39fba664c489d525d6bf46fe6688355988ad6ec84b9403517f223502f09a25d4f39b3c031f33d018413484b67cce5b522e2aa278f78ebc72bc1479e0c971773b5c9ca758cc3c70bb3c81406090bf36522024cd69e003171bc3bec0e39b1a10480d328e755d309848f48c9c24654ec6dff5d72570abb39a828cd05127c28620f44dc8aa0fbeeb1acb97587718c8540c27ab7f94e6bf7c304901e44a1580b97a5ab0982fef832bf1560edd204ad6fe8b04c3af94a2e5c40e3c03151521866fffa2019854ad0967ae255ddd2fe0c51f3b282e404117753527150f58171c52918891c80f9e7369c5a75c5aab41897f56c4206ac01876c524dd2b4c7b21d604e8f10c4eff18c0d8b8cefa72f956209a1a68fd2a82a248c9739ebb6cb74f066cd2ddf277cdc4f3ea0350497d290d4c0e1029832d48557123f0ee74b17debad34f887f7e0defd5706f599919477524e27112e8f678c73cb595846b81efcb131442f520f28352198c4872a26e9282f203c005226f9e9f970c791733d7bd968fe4329b827553a11e5b1c3c419e219ed5773c23d31f1a82c1a79c6809633bb8bd5542def0528b1219b2e0383db1346e23c996ad82045fe8e744936cef57fc9e5021350d67689bc680d8ffc39709db1a3a212c318aa98efcda1c03871822fc59b71e8e612985f4c6f915a568e175a3a0119b75107fdf382876d1a1d136a3953b1791f2f5ddfe60c851555b827612f147ecf65fa9ffa4e9783b7957f7666102b400760ceb193f4253fffad9d5d6f3030e1e50916fcf853ebb8e7f6ad734d4e75d8982ebdb8c4424cdc2e73d726898e24346cae3e0457edd8f154e57e50c81263337b8ad7f43df1a844b86b28dfe87c9146770078e0b4e9074bf7c76db8b167bb4e2ca3c243fb50333ac8af3f33fe6bc4995c0b1960e975b65f9d112a5834cb6386fdcff5f6a802c2500a166583ce333e94be6acabc0e8d5a0525ce6859c48ec18f1b3ae515ded9be3f87f6e11b5ddea4b12476243727e654e2103ee4374456e9c108aa1b6ea86918d967ba7c29d1d523ca8650418e9f051a011dbb890b977257a7a02cbb98200903e72fbb3aa739da4b5aae290681f0f46a11e1acf1e4cf5c4f0d60592092acb96a3f6dac2a0327c697ab9ff2b4a53f77f156c043dea74702f594a0b5e8985299b4e88cd4072ac858f16da93200e78cabbccb9de5cb8ad2458d80f0034656e78807264bb3fe6e48ffcfe56877114fd77bcd1a79dae924a660af9fe0fbe27c2425dc44b691bc60c27ecf52405bb8cb99a2c3e82bc57dc8b875619aa00ada5431cdb8909b68d510466df85d09e6e978f78d1557dfcf8b65bc025631e04df2eff8dff3628c3230dbc703bb955c476a76b2d135ff8ef6da0fe8776574b0ddefc716312f12cbf6993f78898fbb230728b01b406e534ce13246d9c5e07d9080b5b86e4862c8d8db947dcc158e83ce4ee99cf1fdcf6a744c4747ccc268d5d04cc9ccf2a93bffc6421188ad33ef254dfe0ea35ab9c0e383d150d8785b3f3ce01ce0c0d1f4d3cb10a4e1f5b4f22f7d62530325560ff3972828d2f40bfff39d40b13e553558b0908d7f639ce387827404a583d35ce0ca7df85ab62eb4e7f1fc9070472f9052c8693d4b192ff30ff0b7cf52a66199260d99ff9e900170c900a9103ef9d925f2341b2bf19d1eaf63248e11263f314f8394539202ad911f07e2bd707f1c577250fb4c1c95540dcf6e64fbc24c173062c87060ecca62c5b45a115b803bb0edcd478ed6a1fdbe1f44551be006a901a337fe116f0a00fbc0fcd6321740c098fe93ec066ecec694d8f1847e373e7ab9dd1650ca1f2e61414d432ea99610d677e115529d4bbf543802196d1d94a5dc4a59dbaa519ff7798225f87846f480f58a5f504f19215d3b20600728ef9fcc2fced2c396f15a3f9228ca546a72bdd081a7fc6a10323d734002abed706e7286b6a551d2b7544f9eb4d5362d8963aa0046864657e5b96f6ffa7c31ee9fe1666922132266a701bc2758eb1841c5205eb0fed36b8eeedb4dfb7baa2c7305a2243c960d757fef89fa023549c216a2be32006448efc77dd6479d1a5d50ccb8231ad7abcf964551c95e771c922377dadbef60dc10051e74b9a3b0a92319773ec212ea4e2304bcf667ff8d19f5ff5de1f0afa0f7b3a1c56b8b61c475b87040f385879ca27dff6ebe5a94f2840a61723fda0e7086699654abbf976f940c98413b1ad9ede1fb3a1511a54ddefc1e5835be0415e0338a7ad1f17732e519b3fd011dc7c5b6359bcedbaa0e9a2ccba2285b48ff22605039ee9718c133ed2a6cb4d443653b72527de12acac4e1165d3bc197a31a47e030a0dabacc74ee5248bab4d70b04a9023ec7f86da7afcd992a4481fcfe8bc0e08ed07e7964261dab04c425580e9bbf60edc6b0a0b1ead086ee2a8fbb6098add056d5a4da77d85ff70595955c1ba544993c91c938d487f20e94a9ba077aa1f890a3a8fd5842c9169d54db6a628f94a87f1f72fe9b3b876fca670cf42a4d20ff0064f5506b8e18a44c78dd0944f6abdd32a98bdd59df5f7d7583516d31b6d320a0820795d344a10d0399ebbfbb4134c7b24aa4fbf5df9a99f376d4b34dbd3803c002c49144170a521c76b404b84c7bf7773ef764866eaf4bf05ee53280ece2f4b034a16dc9b72cc292e945b90189551317ad422fdfad7612d771800e328e93de702b9674deee4bffafc06efd77b8889ca4d5c0947f8d4edcedf32f93cbdb4ef6009a69b27eaf46b2b1efa0d61785adf09f7980ccb39c75671f38b2ea74f3c73c70acdd673f71b8d0fa7c129ca6e1235fc2d60239c318f8fbcd19bef75da6c467e0e6b2bbd6840e329f8b938d0e0b60220bc9955527992e01543fa61d2c939ab3d0dc6ea6ed740ba7a9c2f886b6f2956d972fb235d18c7b23839ffdaa6c79c095e0a0d4413111e51154bd7497e42c73a064377348a890fdd8468b1d5b968c253df06fbf62504d9283acc91262be5f1046e6f4cfc912c501d44f7d51ae94bee66a10aa47ac5e27a793b80918eaa0e74d39846d0353356e7c045ae6df98ca0a81dc206e6635a28b8389e14802fcb53572718f740c0cee51fe7b7b851368c4b3125f80da94d4f508308968eacfa3185e5ed6dd81abeb0e737e08afd80a890d76271940774aa3958f248f4a26655010b859433206f7033c4eb147e8110a7523fc0c34104b50e8e2aa1e1e4b1bdc78a647a5af3d8388c4b8dfc9bb6a8b7db5712eec3be0fd33305ffda96482aafdd6b18012b6a73d2dc77969e22c1c119e73c276b52490adff7646363e066bf3b8fc0a859f3e838df38a3298b50af936e61efcdca5dc4010dedf1b683dc73dffc3988904b2ea42844566551c90eeb7a68141e8439752b0fad0559b37303dcf67e4ed0247d242b21513e94e1cc3d52a929aee8129f8e0a077faedfaf9240cb7fdbc54c5190c6a9fcee355ffa24b333fe58ad8662db0d0a047791ae327828e94b7304163d765cff741970b9d04d7114ed25606a7676938f0a736ee3cc815d9f37f12d68e6fe515a8be844fff3b1096cc559066b56e3b31001e10a011c2751d1b989886d9e6b4c3c3214d8775376bbbab972d137cb349310085262732baf3eee1f824ce29cb8900bf11a9cb94647ece6e2ff3213de6940660c0579b6c26c5efe7033a833e1742c4d0663d0d551ad6b15e7c8bb473e51040b0f3e02544f9b1756bce4ca99b9f8676e24be4562ae6edef58a3d5955e072baff073d107939be9a82cfbd15d2793280c3c21062644260a68bd1622f9a51ae713107c9b205d3b4c1d835004188b14ece232ca035b562c86532b28855960617399f09d71c26e63df7168ebc17f1e9eda6c5f3aff4eeab5027317dd6fbf854af2620098b3e8ab61448883222430180e9da2fb379b269f5107b8cde1cbf170bceaf0809097d2095fb7586eaec7ea1d624e31f10c214c2380ff71855cf01a2fd2875f40fd5551a71dc0bd304c16661e8e8d7a2af45b96e2f68898fbe3d4cdc787b92ce0bc008c3bfd121b8503cfde3fd73dc1258ff7a3ce1e165dfa9f181e2439ec98a08a92eae615603931537f9f9c5d27563a18ac2efede436573859d32ce759094308c1af620828c5451039d3f2e79564f60abf77f8600226cc9d11676a7cedcf2c0aaaae1873f7821d7d96a927f300afe9760bb678663ef3412cf928aabb46e3e80a01ecab94191887715d51bc4f3fc0e181c3876909a68d24bd35dfbde942ee99066ddafb2592fc91be98fcbfe2af7d4b0cf3589c65c3abb407835e3380270a2b0c511750c9186a2b30df44a4baaf7c43d682a9c4096f3bee0a4e784ed1b148c50650096736a7e694a2ae82957635e5bdada7113d962ae5fa5f5f6eff1c67eabb0d7746ddfc827a5567130f7882eea9e0e2d70b6ed933741f2ab7a25930088f170f40f40438307ad02f93fc370576bef370b5215f6c879ac0a371d4208fac1bc505de005545fa03b388b05169cbb60deb0e5664f0a1d5624e3604ef03e70f80840983ff8bf20c8e362d905a3ac817ba29454025c640e587aa57582843db80d56404b068984e1e94f5a9db224f5634af56645cc275c3a6a3fe834b77364af9f4480c87e0f2e474679596c1f87749191427ac9582a7cbc183aeb9225648cd88bba00b9705f483f60f9e9fc94418d660e3d043d4b0d0cd5942307e0f80207edd454c007d693327415965ed4edf545e2f8a87deca7061bb5de8876dd19e403d174b910bbf2e8bb2f72cd1be56f357664eafb12871a248d66977b962486eddbbad0aa600a70001c0b034bd5a29c745ddaf5adc77e0f9c5bb1ee3e384a896ae24245bad0b5197f28d05287c3cf317bdb3d4e4bbbb287c82cba648f07849346755894f240dd5eb9eb345b12244ed4d65742daeda6a0b83a3da63bf2b31c9f7457e0a53a602556cd71b3b459d573b8a2378638410953a4186c328d5a0166401a55f0884660f18fba406aa9c3ce1899e580616343f0042b2954d938b487ad72dd6764ab4830b5ea29e548a2ffcff5972b50a12facc1a6d6ac671b09c44ec7767f86597b79c0c7f752e8e3847cd66e6ad498861dfeb5db56c42365a4c81054c3a8fd85ca841097e92278ed1cb8a4b710abfdf5007ddc34e2938d59d2f33b6623dd02ca109b10c90e49f07531d4f90257d2efeab0d23187f4fb4c1d223003442a562d2faab5809f16508b285ce8f27edb11180dfc0ae07c4d709f27031df66bfde5ed4b0e0440387ef3134dc0bd63054ceb851a5595cdf891b299a4671741a946dd216d176e60f936c04ae48046f695ba7370ea956510a06c1b9db07281a925e9dd9c5d548850e48baa4eee2d8bede6f9dc267798d252639b521e3dd425082b0a59994457b770572f9e5e760abf3ea1bf3278e55312f8854ca2fb9f623980fab927a8e4181ec01bb13d1880701022d4310b7fc7b3533ce347d955da25ae8d88a073a22c2f5070eb920008dd5d9bbc4dd54492d0f4343309bf9da9763ca68ff36de8220f052d405f1e5b1ac08ab38e9f58725a88d888cc2271951c9fe477f4b6965064cd5489a0201e3d04cbcb04057a325b1cd9e9967543c6ec2909bd4273aa846449e761eab0e7ba34815887b9b5d7ad0973aac7e5789bde36edca10904ec05a22e69d8664f0398ac6cb90fb816dd699b1e8a552f652270a94d7fba29635cc8cde84c3ab4b60a74b6c9539be2f433432d62ca4c2d0b822635a0d1c131eb5684f5e6023efa780d99124e27edfc4ad11b073f67107b885043b75d40965962c55f0b98508ab9d704c4ef93c0adb4dc62bb0821cdd41ff55d75b986e226dc8e46b124da07ce14f207241b7bd64f8c84ddb119743371d83f7fcce93e49c57a2ca55f759757edcc8c0e47128e85641e77fc72ffb5e9af8fdb2b05006190b1deea2d58309c400765ff0af2f8f76b026b0c97d3c46d30b9bbb4beba2e400c25651d6bd4c5288231e3510909bb4bf01f35a35fdbf980867ea632a678132b9050a1d1c4dd4d99e2cd5cdc03383347c24e938bc4cda616660e6eb24c9d3aa09650035aed6b515330681fda057fcf8aeb7c286d1eb31358d78a63aa58a9986b8724706dcec4ca85c8bc937a0048bad29fe327cb121aa16fb77c27694b3421141b446a53918a863db95a565a00614ab027c3608e22e0a4d2db4153c409057da820abd06a797141bed4159d9d0595c7090a893ddc8c1654869b64d93e4297c20922c803a7a9d6d91751ffacba08d5d7b86dc2251060c86c4e1efeb3bd904952976552ca3443bd420d783d6ff00fac93257d5bc947a1fe6a917b050c5e66346937ae234fcf3e68626f2dcb1eea0dece34bcbfcb2cd4a26ac2550db6bca46512f9fc8adaceae318a7c5c29c9dbb09e29a4b15f9c5fe781adddc73558f6f9fe2a660393b0ff1feeef1e49f49aa280802dde44f69e35bf642e638d109609d6c157f258ca408f73232c8ee579d11190cf2b6dfef9b449b3f6e563451857db8c4d06cf3353e4c1c84e8165be71d1f8d0954aa8514063feddf8f5afb90ecdbd31b9bef5d22e7a3eed54bfffee4e42600086482140ba4cf6e049edb21bd93405e9d2817d9aa1ae574cbf41afa6ee5eb3301738ef31ad318d5f9808776a26aa4dd0615209bb64d44727ec7059be8212cc4003865f9bb1669017b1011e910a7e2c55f735da25b67f3957ebe1c099f88268a00265206818791098329240367e9af65c52d3ce4979f44b00d8be181bbe8fbe60199443f7599b12ccc304946672d52e39ab9a2523a4c7157c47924836a1e244f089c9361045eb882ad3f763d2b8467f2fc594bf253b7921ce24b412af3f1bfee041bf3327127b9d6597893d86a78846d4b6e413af35d3567042c6a0402686f190b9ff020e8ef83085cbf64e1b0805c82171a9cc506b7470826e931369edad30d48be7dd3073cbf87330b2cebc544e95a4d7a248a6593b3f54c0c2cfc062fc933bd6611e67577a40a4a8af58f6bf167b5392bfeb5abec007b451eab990427609feb6db384f3d52fcd1b66b191780cf5041ccfe78be4af72cae402235c4bb7d4602dc87cf034dbe0d147f0e19b1f151490ea7a76d9131e1c94146932b1ddfb05874ca75e3aaddd65fdc96ece948509381be22a600f168c1f81a8745bd0765801beef927932d670165e6297f0f33c671a5d2cbe81c7babdb84c69ba9a0fe816932c4b932992b19e42747290c02f38233e576f65da2acdaa94eb5875e2661768d31e4b8d9a15ca253aea585aee15e55043a8e00dfa9f50413fd426226c222f3253584281d06f234514889414c4415c1041a0a251e998dd9c53362cbc4bf5b8b6c682ff552fb5c7ffa569addc619f644c28f6a72aa5679891a1c9c3cf7eb5cb5e4dc9396e0a6e48c21a96db9c78c237c2a0aeb1250524447ea95ee3f08eb0b2fd4918f8e2ec4a93f89c3aa08fc441b0edb3f92db35be2acf5efb1057d8030ae289ab569e4d12e3a95b029a6ccf38aaf17d5295237a77ea819f472eb1089bcccad559c96c7308445f52aaaca32bff5b96fa05f0acf94a7098818f9aad854cc4d022e6cf56cc8f557b32292b52427736979cd021dfe272fa37eb8b5c34b548e27d4b31f6a61063db06d3f39c67cc3de4a885d823e089adccf009813e956998c21e6c3ed4be1b86e21dc0aa1bc88b47cd5afa87f1f447e05966d289bfd3ad623587e020aac899bb6edbfd8e6e28c6bede435d66165a169f54b8501a32f44a3f7807bfd410563dd040256e57b4771dc571e154a13f10b744b63fb4a05dc69369b1efb914bcc3774bb2118cddcc841b9da0e0f447762640f284456a8748fbcc392f7d1debc4cef0f8d0940622583a0a6cca5cd44afdddba35d2225aeb1845bfcd53e8976dc7c1c7590cc4be543ca7e752b729a99a1b76f8196b8f459b24cfef79c72966e4fe2be70fa3614e4068a75123860f9988f4f9277e6fe8343d5ce362f2e9f202e83f7234e1de30e5ca0f51bda11030a48c2efe2733cdf416d60d616f766d019dd2147616102a3d1ba4f76070d0f0a94767a9ed38fd81cd566752c3a8a4c9700900eb3a872057da8bd92268c8c5210c9a4f5877ee3222cd6f8e535fc9cdd02cdbd2e6bc01ea0bbcdb29d3d0c106070d26bc9ac5023024d5c5cb009df5e9f90d94f23d48bd4303e1f61431eb40f40ca0c96db0bb4ee3d30897e0e16faaee50789a4c5533db636a6897f80d2db0a129bac3e8b6e7a4aaa49293265bb55094253e0fa6ccc7b6de59aa329a29c781e85947e23cab4b97e9db31d0c07c1c71daf6b5a858694c0429bc58cc0011889c9d4e709df8797f09643131e8cd1873d2123f9abe4744fdd777f252618c1cc668e8f36bb15b418acbf8ea2149c17cbacc0ff10e01461c1c61a0b3190e362bccd0b3b8bdfd8deace86042245f5429154751ee511bff4679014e2f70b0e75b0f50d202fece826b4a84fa88b1115459c89010a8bb98d32ffc4c81fcf922889e8bae2b11084ec0ae4be035e151b931d28c022ed1e042edba2acda9e39958fdaf323e186620feafe3ebc4e88734cb501caeaaf8f5e2f5258402d63b2029639480c4f845212f3c2117bd69ff5f25ae9c6c7bd533852f8bae49d8e1ed6de928feb5fca6d15b23bf9f51a3e6b221851c00c0e23f0568c56a58c17a0b7e28f70c98c5ca47c271e18b7c89db80be4ab7a4c2f1191f1da794af8f3070edcf322a8fc24e8058a00734736b1f12986f171a785172305ee0ed2549a343c0b38fc39e836c805d14ff2ef8b423de06ad6ec1b6567f76d215a789db32b86814a06a4fb802a067ae3b2c8b29cf3da7cf0caec308c1dbf48c86402f554e9a69c1eb2e545519b7016cb977fbc1f2131c8997f39ea09a44c272062d4d479980e30f0f2c31a22de0f1a44ccda1cf700a9d4e22cc25aff89b3cc8e3132f147a124d96a2013e4c42b01f28b11ad0583bdedcf231a868c124b50484264bbf3cc85c68d28f5e049fe2b05fb992bd5a2a8af9208da32124c5771ea82550e10c222f98022c498cbd3f532b7039d7e23b689f3360f3e495e7c603ccd48b936c62f42e37b79a1e1c12229b65914004ee61c1aae5cd18f8260adef86e4b3ae03674cd2c3be043b63b3853b7afa69012bcc06dc13aff3acdb3f7911ceea3452aaf990cc44c9028b6308b4c3f46bd5c4485c013d2ed56e809e999840fd42425246940e0147859b889ed461d9bd0f3e10bf387fb91fb12da29a5c9434116add32b6ecd5fa1f91b97731574daca37567460f8f88d8bd09b36f873e3ee5afa5357b13e8912e007bd2a8096ab9fb0df292beaebe07cb9d19550d4624bc3006393289de5042ce0976538d0b4d89ddab6658af3968a5c488f9e55bcbe91965187a44eacc66469195047e3f53a3a497e40b01bb86d409fbea121bd82d6ab35bfe61b8a4572fb29739dd8abbf1c65dd08a08c19ab3b50a341d15988b3acfc1565aec66390dbea9345aeeb09c21ba8ff8fea4cdfa43d3d19e16c38f46c596feb87dd9078309c5242602b1d723e135434d650eb36832aec643b64d037fc836e5af67b398d29bb76c8a5a3bba7ef5f5c951c8226f8fec36676bfe1cbb624bdb21a3fc38e40a48bae76e4537e2e1eb5d341846dca08df0902b9c163f9cb94bb18b9db4d9aa6f886d18cbe0098a855d04be57225772357dc015370d42527903a2bda4ba63869d74ede6d514b1d53ba05766bf95e28f7c214c90ad68b5a505c3db4900910770de0d269a9eff509e66f5f81d6c279014a7dc7d134406c01399e425729bc9a122a5d347e11e6c17e8339de9319315ee08d1182e410483ccda628b656797bf29b189cfbb382dc35d0096f68977fc962109c95fbea68f4854ee82e93d16362e9afd7cba6782fd6c5310bdf53be3abaf670fcdab1808067aa9d1885735cca956393bfe025fbbf9003430cef380b516148905802bed4f7835d2c4deaea09429911c9ccf9fcf734b081410dd2aaf9edc357fc9ed39ddb5c9cd8c5a3e49084d247752540f59ea0b183ec7f0d014b28810c9b4f050345d062e58ab8d4a1fb81e270f4b94e49cae6313a3ddf008c2e05118cc08966136b46128ee479e8e1d6915cedf5040cb4121b0e4105f205426788054d631d7e7990a5f463e6c37a22dedadcba71ad11862af4d522ba8d012e9c7e74715406c09e87757e3877ba75f9d9f906767702a3e2f12753625cec0f0385a10303ef8ddfc78dc8bec5ff88e2d9a9fdfd8e1a37f9a69d6d9c6b4b96052ea9bbc70716129253c47757874f8d8741b12d831d3398d4c9f42303b226f3054f43928fc608acddfbcf413cd55c4a190666dad1cf0fd13b1384519c9bf4f20f152924015e89fb54ae2d0f1e9b6fa874d550ef0ef14175da637d90f3c97d800ac7bcc91e4086c087c5cf1a60818e78400aa0a3c4ec66e5e08741f61f936d0f07415c011ca0514b66566f6d4f265401c81a111f2d03db611989900bdc512ced0212d9cf1787ff97581b1380c12c6e0d9e7571672939102fc35efc5270f37f9e00f539dab9b5658859e36d0964d6435106bbab7d6cdd5b264b863da1d104866806").unwrap();
    let tx = deserialize::<Transaction>(&hex[..]);
    assert!(tx.is_ok());
    let tx = tx.unwrap();
    assert_eq!(hex, serialize(&tx));
    assert_eq!(
        "0d7c93d18ce73d0388cd8a5bfcef05591f06f84b79665538f268c1e8a23ca026",
        format!("{:02x}", tx.hash())
    );
}

// Rct type 2
#[test]
fn deserialize_transaction_3() {
    let hex = hex::decode("020002020008bd018501556e7603296bc68b1d1a7e4191890891c7dded95b9d6c72c193c80ca09b03f6dd8d6e8da5a17020008f402139e01ce014432313b5721a373e12dad8f4b1e209ab9dfb5f2db9038b226e4bf15a9085b880bc68c640200025da9f0ea0e9c0c1a70288cbe310747affb60847e6d8a55c429943f6e09f0ab4e0002e98adf0f145290f88fbbbfbdfbb7a730c35dcd9d306f61692f8e22049652d717210113707579bf3e6de99d6c228f8ce9df5da7f33e56fbd65e320d5c2e0460b360810280b0b8a768d28354a986e76f44b12fdbf08fac1fa9a454b60d82fee1d0af8a39a04ff4d196469a0356ca9ea985fd059cbba44fbf003faf855aeec7ec12a70fd4aca566e2685a38660f92158dc50c2459d33c13a1191f1a8f0b91a0c92ad15e79b7735c20042d0bf9b063e8e5767638320dba239e81102c0855e5c4efb38c2f4d83b1c919078cee72a12ddddff48cb9bd272644b11ae9e15e73234390492e50e00e59ffd60b08d51073b17bb67e43a01f5fb85677d59be18e083c2acb4d810fc8726cf33406de403b8bc3187c296e35d40af3ebe73a1c2a50231f71cee99857d636b48b516a839830c7a6760b965b29d7bfda3f6f115b2d16e4f6d49bd5f718b10f1dfa3ab282fd7aa8b35cdb38233463ac9f37ef064aa726b866da03ee07abb9f6d942dd07b30292efd33d0a3721d04781435b423a969ecf1e3f7870aab5c3db4eea72b8044cf4e0802a45acfacc0aedfe6f801721da54d75444995d2fe5031cbb84e384030af60e0669eb6b093bb0eb6fe43e9ddef9b5b46da5abd96e6f94d2cb44b9a10c827156f5ec49d860deb311a3fccc965fe995541f55947ddc8a1c8c546ad1dc03e731c263f97d01e6bed4f73d1a897bbad0a5ef65c374b3ae2c21acb94e7b640feb5b68e1a4ec10d3e4200f1368e83e0ec6249d5a2de3a047d2666db8891cbc0259d70d46ab9c8da7631b5c455aa5dd616da01e572795ca09473fc328c65fdf069aff545815cd6ac52a33a177527f6b265ee15b6039711a2cd8705663abec4c094ad5e30a98a80701a3e1fc29f2afde1d6165f2346f52756d65eb3ad991c6020101b3f76ebef0e76257108f4adca3626fd58a0679ea5387a8c865bca61953a908b548bb6ef676d6b92e01f4e107250823209797d50fba60d3625ff79e683c4e001d61ded30c84451a597825efa08c13c41cbd7519f6d59252a4b0178db4e2d90b1ed6d3fa26ed751567ddf259388d30bdb82342804b96cd24026f341ffbe1230948e36c88332247bb216b699b0cbfb4d0140f0617871214da8dd9e2fc83cf4c0ce28aff3577c5488089dafb2b490061918bbfb254764f5023f3501635fc18d9085125adc106d62e58516f17a0a7759004d6ce1ea421f8f135305716fe6e1c9f0bdd2a2e29136b1597caa7154527fcf0b14328224164c510368d120c2e13ff0201a6df78b9c5fae6bacdb280af6dd466dd4ccd96d17236c5327a6a9a3e11358d0867efd179cb7edbcfe5fd55c98ae8c54ae7c258af78e1c0418084c382e82b340543888a4270301a99615e4b0376dd563dcb6e46d848b51c853c8ae57bac44740e338238325c0540e9df1f539cd7b1491586cb5f1ad0dba5760888a940dd6daf0bd6d720dc5771ce6b8c294967e7cdd7f933c4485b0cc65f2fae3e9ced7db24a05690e60f0078364f54549f24ca36c6babdb959dca2ec9f9216df57560d47c570591c2c38e19ae3a6bd08993c6d43d2157620301c5bb5ff591e1bf1ccbd1f4400409490911418904f2cb5fb80434b836b6d41b44442ba460cb1f24ff367a3ae70bfab3125b78f9561d50c2f6b3e9ac6783e5cc1ac497de6d63c064ac9f646b50098c3719f4434ef080ac047a28464445bd1d0bc1efb81d3e3bd3c91a71587833069b647094f6a1f1ecb343fdccaf407856b47c85b43c45e7083e43d8b58e72b30c4bf2b22536d4a395881bda0c6c67a76c4622ac126a79fb9e8e76469fa249060525d8468401005b81b31a9503d85ec467ec0640d7a526feb1155041ea764ec00745b8189d978827c4da0be0a17e6bcc93997d854c0ecebef2df870b83387893063c2b475a40a249856cb09ede0584e1e82c6f9f4f2e8c6e701e37d4038ef1fd01f070edb3a17b2128d7bf7279c08d60c704dea7f68d91fd4bd12c5622b4abf6066a197dc5676c418680c63fdcc20d9e6e6bb47da2a3603dc51680a22b140434095a6020d39960d108962386f2263abfbf7915737df1a26b9aefc6b71afbfa21016192b4796e2c775804fe3ff5964a60a62bdbf212b141357c960bd5362ca6c2067cfe8731e5ca452522eb9b896b51c74e51585f1b3ef3c11e3d0fe15780f3460fe1683839227fa40123864d97423ee5198875fdc22c77998a2b34248f6ad1fa0650853e924c3bd2241fbce82d4fbe9fe835baa1b715c3c041335f3947c8bd3a0d8eddc50a5e6ab2609e855c44b0d1456083614a28f06cbe2f315d2165bce62308a8fc3e8490f82f83cb35514a77145776db3778ec2c7b2d5f668062e32d1fc50beac609923f23c919c0d1d60f30c7efb4bdc6956a6b9ba25ad1d67e4fbbcf310f24eb891be2b296dcac9e19f1b64d60ab4137e54f3c100a12120d1fee2793f50fa4d0a168cb336c74a339a5774383e038681f69ab18d2b402cc37451e479e7b08a068b3658f690b9efa0c2c97d7ea2d5f7847510b48ffd85c92f3dd69a2d0c5079a241bc561f7e592e32c6ded71cfab737a077e3d7cf848a70346de865ea2c9018132a7cf754f8beff671392d8bfc8a3155e27ccde367ebacf505b1c23b3809064ef7335af839adb14e85189445bfd718042a1ab22e05e173df7c45e11f2b0a01aabd7220c13c4c983765457d9009207f9bbd01b273dda1d8001412e6aba7050ae9722df845fc67bf11172fcc21417dd9f27dbfba83e1d38ce7d9f95f83948904a0799f4076d33264b5edf612e1fda621df48d074a6cbfd19f199221b74756802b906e531381fc61d46e384c068c9df409378b973e3084e12544c573513bb650f2819fd71b90608e69b7379345ccd8302c896a096bb978ac4207e0236b3f55106b214b6b6e679741c640aa5f21a2e4d0aa17e45264e21e44092c0fd2c5b45100b2186ba97927acb294b97f6b6ed2efeeb938dc404a2f4f9380b2001f4273fff0e0be0e7b9dbf375a3d0227101eb52f01fc2e3702fd2bce99e0b8e02aa15f0820ca8697baa84afdff22913ba0010a36dc74a02c1dd03fe4dfcdb48e48c9e2eec03528e707c38ff0de929066840fa1ece5d6bd95bc12f2c3ca01c29ddf0d0904f0a703d68e688ec481ba8390b271dc2a43014d70884039d3008cf0557864b60570a625c6fcf31556c42ae7a862eff62a70f24d70249aeb552543bb62036d5f6140add685451ee12534beab803640a72a2ac92be447cd200fc9273ce23798cb2180a7a49fb6a3b728ea2a577d63f08e3aac24c17e4c12b8333bb7979119d60f2d209024238ba87ba2c10da7421ba9aa38676374842d8e0d0aa565ad5b07d025c090ec64dad28762aef6c4fa9abea965243080a15724ecee89a4e4bfab144dcbef604871ab3373ae70ab7590d0771aef5328c58d407b2aaab6aa7a30a39bc5e53920245758e24e98ab90cc634c37d07c028b36bf7599eb543e7507dddd47ae1edfb03e4cf208fe459c912d1c1b7b399dd97320bb8617db1b1eacd646c5c81a3a772013da311446e82a8912db1c42df9ef6f3acb68a5e64c01ee36e56155ca867563069f9ed46ca7b97945f42df42f8b31e841629f59260f8b6771b774a19b9b00bd0c7a7e2fe100fe175124715510dfaa3b7fd51190721b42a17acf9838bcf5a08e013182faaad40229b9155c0c6cc9b9fb90c9d2e592fd731f2fd9cdcb16505ab8048bf0ed941cc67dea4d26a9b0b83e3d3805bd9394f5f65fc70c95555066daf40c806cb16166f855667b3db51b8a29905443ee422d4babbd573d28cce9d7efec0c22745bfa841934a7d40633da12fc302a53bc4f176501a9d8e1f15e8ba0e450000fbe30cc9a4bf0b930ddf279acddc5477cc938fef9e2566aa224157141624c08147b7ccb3caa730f962c722f8e786c630bff6ccf218ef103029a6fcd45e8700f159ac4a3bcce8d9a2b0708f5c01877aeb8a1ff0b0569f0e7f8c2d2d7daf7c10844141902d1ffeefacd61b45411c8ef185662e45641d1c28f424031bf07aa760dbfd8e97b5c5e638966786bb97ed92f8312f17bebbfddd8e41c62cce2b592a40a2b56c56088f4be144454f7540cfe7a041a5498ba8ae836e1e4cc5beb9cfbd00028d04a1ab462fb4414a2c3a6e03a5dfe9c7564b47f8c3e9ebeeb7aa21644140cb41c5c9b3126af0421fbd334a38edd0d703d7e2fb7e95cc84c5e8e154008c600ab914156d080db4a663ba2c6b7360efc0101322e81da035a9b03d62f7bf71a0fb73a2fd736a71961993e646a7d29a21589682942bb4d15b35eb81990aa994c0f4f976ba3cf00d4470f57d2bcf5521d9b37c6771a3b7b5dd4f1ff69f7580815092266aa16009d8be3773824315d776f764d544c99ef183d07dc8a9f445b449b03348e0e33c364b24ce4cc9d66a1386ab0e6d943ee47254cf50c8d8e7d0e31290fceb606051e6ab6c583364883bdfde27a6b7bd56445682d6189f3456189807e0e19409f33de997c2c94139d33cffc4d01343752e7f1d943a6e35cc62afa00b50cebfbe28b88fd5dfc16801cedaf56d244152ef58ebc6e4fa642ee9620550657048fcadc74020751698172b760d2e89d84461f1288d4eb98dafa15fcf5f43df10d094f82b65c97175f824b3b52aab5992cea3de4135143f8182803f6323015ba07c6a3b73e3722f7556d19387dab7e731357c85156a95f2a022b4450d482d0a00858288f157485724d13412f2856e8f2310971bf6df29cc7895caa216bbdef1001ac55f9523af087abc52145be606d7dd957f49f35edc186ee56c6498b850466043cb879ed98b8b94341384f74d2780faf73387a524402e22e67f5ac18681ea005134f8db6fcbc550d0e9218dafd3e52b77d036b9f220317da6a5ebccfb0c6440a32cc0272f818ccf55b00fb610e025f5569661d994c78bd802637937b968dab0fe9de2025edcc6fe233c0d7409068d8eeca711f1a6be87aee2daae030fc134b041b37d136655129482e15973bbbb0734f4026ece683b54b38048b66c72e46280129dd85bf165abcd12b5ac397050ca5406c3ae113bf481cd7f781f185df8cf10019a7a62b71641393aef2cf6364fdab80f888cc58ce348da3a50250d377db270f7ead24589954091f0cbbe701bf4a544e9bfaa6fc3393a51cf08a1830f95d110486595338d96869e98322e20cf68a5bb496029ba59c284babe6a846b763b6fe0df983ac3d4e02006e63627c5172671b1e9de9f36b0c517fc78f95dcaf19ec5e0c6306794027a6c99b87ee0fd042624201765859b25f86ede37338220a6dd3510b922c2e5adf3f6b95caacda9b01aa2e8ab0eb0c626a83d9c27fa6d0812d58e80a6874f52fae256da31abcb2dbb21d442f0a7d7a2a132ea94ecc42b2acb447da0497a6e9277c92a468e7698311f82405f51317da295f929994d0684b7897a26a0b987f329b78661b666c059317f21e860e27dd1fcb48841dffecf39e8e3a320905c1726dd052f37d44e957ccef97c49ee3a820fcdc385395581c5ef666bb49420cb5a9bef3df746221c7ac50149b5fe2ea3707d4cd6721eed6ebe903ccfa72f00557abc2dbd9afe670db5930ed52c923182ac98a0b7742707463c719d1d0729c0fd91caeef300d79ce60816747528119279ce23f863f67b687849e4b531da6940450fd4fa61ec165ba1b0f9f85eff945560e4141d194572b2a1427b52236d14702439695d7e5f172d77841bd8f7b357872b2e3ef31f6165b67c366a5fb6affd2084f6fab49fd37c30c8745bd468b49e20e56f3db823a45a3ce368bfb297f55a30bf3b5e733f715e8a7055e58a94b2b7efb61123d7c22fc508deb9a81b260bbb706a236621060675867a5ece219b81eb04f08413151f162056e461fd9b4cd9b070c02bbbc6d09d67c76c4f7883c3e87537c427cbad6c730faeac4a21528c090650f39eeba12defcd7b883cc199315633bd728d33c17b6c93f1e96a8a49b677b520878c3752f37647cfdc3b26d7ffbd7d5b132041bfed5068a3a92cded3dd643c5072b0f000f581074f5ec3f75498efe17223bd09ddcb9630115579708106ab94b0c0449b14d45cdfccc2d5295b6c896020850e6e510f33946589b832eed0af22b0e1ec2482fa1357a7c096e593f1bb4b6793102d31e7d9c76ca3050625dcae7a803a341e2204590edb1b05517ab6ab68414ff84806c7220341911b05c1128b7bb06425980c1291ffbe2223706173bcea9ce93454045dfbce2e0a74cf69a8117ca0965f8c689c0c7213da217b78a7d9050ba369e6be3e7347ca81f33c3b1ddfab9043fd361d9d8a61c7a10f381fd401bbd10fa9e2f8449122ece646ea70ef0c96bb4f3b3013233b8d022339c13e7c4aa0452d3d6e05b662a19fe807307aa0adf259359c06b30abe6b59a638b9f8a55a6822559399a3734353c33504a6fd24028881d8622e09cf0315fde0dcaf336e4c064457e863aff27ad57c4bf1a0c530814fdb5735e0640e05b03b0228d47bcffa3f4d78fcc7b19343b2d2cada4681a3d1bf1d5115ab21c14c14f2827344f8db14a552ae3f789ec0c02aa6b39e0ce074016ccf202f321c04e1c3137392174b0e8ee9e6483672e1c2ba0c097e8ebf76b0e4632d461d5b24b15d397decc282a0e35d5b907573571695df2665f75a49059165abfdcf60ef885da69a9f807d9acceceff045e0bc6e942683cc0598fcab77d5da97ab33d6681dc0df22b63d3a488a9607fb838f9f7fb5b20770e6165ba3f2db07f456d5b1aafc5ea646758e20118e2fc381ee79c61a64a1bb9049d4cde5d946a402838312312b4ad461ca231daf9703bf834b0bd2f552aab1ff2feb7a205600a62c0b5cc3d1a9b41b748201cffc4cf6f0a13c3826e23143bd1fd6e22e7bd6ec351c7a086c0495d70a765cc1b4b4612d3face7f79f810f2cc6c21b3f0ccd02ae02074b5f2dbd31d969623e29e891c5a5a702a43ede13579bd54ecf614c24d5d1e37e0f057f251ffbac0e9073ba184dd38f3893c8692c038f3c137c63efcdab7b3f2eb5ff5b8cbe139509e891afb1bdf44c8d58cbfac702459cf724af6b3eac21559adcb2acc7001c48fe81873b6f2026e0cd736f2186a77c5c1e50681e9c1752430bd1fd1d90695c081f1e4ff309b03bc5aa545150dacf8196a267081bb36180e259433ce5e1b3cfa1ce0d13de8bec432f0e17581d871cb6e00df2fe829790e548fd85f8db52dcada38f4f3f55c72a3c92d10ce88ae858fc76b471756b271a879f1534b96e44671efce82413704e9e224ee3316fb2a5a28fd8dbc19ffa93a95e64ba6f3ec1666a8c523f187f85784ee9f3ddd59dd43838112acc13a2e20db427308266cf02c23c9d0a172bd78a91febe792fea4f20cc94eea4a8d3c5e90ca6ff455df525c53053ef359b7e73a0bbe85067d7d00373dc10b9b240aae8ae25f47b6f02e73567ed7530ee35b5cd9b6e987a0d5c4ff943bbdd86801a2af5cbc0bf0686d430a5d6ea5d291707e78cfe45fa0e1f9655395d2a3f51cae87b298d99daf8bd7d8ce24ba26679b82468447682edc6c13188730f27e2bfb7c0c4233b01a6bffb64d51c503ecfb9a2121c69b1715f336dcc42717c5acf68958fea5775f7bdc316d054917a150e62a13e7bd3642c8345e5496d709e6575b03f8ee203c288becabc7f343bbd93f298b4ad4992332829863b2b0aa90acc244c756dd5c18f5640e2a17962d3b6865e3a5cd25fed569e673d8b4bcf5a655dcc2ece4f09d31265609c6ae7b4fa4eedfccff780bff8cb861a96721dc8940e81bc19713a8d803772d5220b8ef1a373614cf0b25885e9163733f9cbb1ce4079c443dc41f1bf032a5de4d76c157310dfdf021894680e0b4d7bc9d8d38f88ad8e884dd6e2a4701e1fd8dfe320804c0a52da0f0a6a85ceec25e06e882673b263a4c51e9c765466a25c2bb61b3f952b4e3d703a49d794207e5d4e55cf7a99f2ca4b7d95cd0003ed0dac68067b0cddf73dbc4dfb29101dd647f51168d48ace07fa8ecfeaa6543ff277ba4de766c03d14c66b64927c8c7f0fac3fbcb8e79c1c20debae6e06b25eb75923c1e90a8faad8bdf34c54a04daa0af7b3fab39e6b0d4bc7891dac326f07aadc53a77387506d41e3cd02f6e68690f9ae387cbb46a0a33007a3ce2464b592f38a16a2f8179d0969dbd6088d1d63f5ba3fafcb2f7889f318721fbce91de9940476bc30f48af41d6bf66fde2bb0da4b41f5d57c908cc99879cef416c620bb86912df687fd9d6a114f70375a1e90d0ed536cfbcce2b5ecb20f899c7cc43fc69c63af62fc62e670af0a70ee2eb0fa8f88be4c709a340dd00f3ef4096ea50dde210371e471e7166c719b4280060ed46a6061edde2bc8468e41fabc560f02087a2c4cc209573c27d46eb0d83dd9427baafb603c94c35cdb324c26cbbfe83cccd03ec3819f410ee925e692a5de95ec279af5339e319bf9e7833e003b14e2e3c349e1b4f4f1d4c6ac51d85601c437f9ac23d85af4b77dc3c34d7d85b382cb94b61749ad11ee79a8b2f17b51af3581ba86931bd17d726ed9ea24e790021382509597b8fd2469760baf1038089df19847c3f9d8f0417311a759efe543280967180cdb933ae035eabbc996e84d40c18314feba6573ce7c014bf108d9f6a4d669400b17bf72694fd03e4ca98f380b5010f4a5d15d1ace44ddca3f03523f6335e43d417b15cda1203e2c3c9210ce12c7413125387e492360049df353b386a89d8535890ed9ee9fc7c9f35bf1acf426a55e7c4d6f8a9070a240f0dc6d62ed140ac3030e0a497effb7913896f4f912a6081f9b7a561c088c2c4be0feff5171c3a282186b160b5e4528da5b16a34bc051f5e0c42bfef84a8b42211be8a5bec449d98deb2467929e2861a97dfd018cf7b40ebfe0e2c237ba0067c5035b8cd86e9bcdba8bbfb8069bfcd1ff9e2609910004cf9a39d605dbbbee77b634d08e75f80c2aec35e7755166435f9250b483f6966361e54b6ac32465a67dd66adcd2b37975818200ddbd63f89d7cc4b8e3fa098f6a6fee03a3445bbaaa247986eaf3ab014f43f40d0ff95184b64a001c37fa1ec96b41cd3df6f04e3357a5a0acf7750418a985bcdb7700d59ec1cba4f031825c0fc39976b3f549cc4f0dd31638f0810c58ef2f51d0caf27030c49a3dc9916eaba763606684f2fe5219460ef4c2528396c1d8e67e25bfe58a28514b50132de45b13784b417b928505d642ea0a5b63edd4b49a1da3c1ed778d91c2827a069fa8c53c0782144eebd9193d1758be5ac42cac5c442f480f2d91636dbe848b0aca50d03c0175f3ff4baa19d4dd54d8d2a4110c7ec983b60189c73a5e0ba83796cf0af6df0bdf2dacfce8ab3e18cd58392d37471e91dc8df83f6e378afa6b85990fe36cc60bb9488c871236bcee3bedb6cd0554921d8e68b9917c89bdc4631ee40cf0b7650d48f745780fef2e953ab450baca964a1c96d3a39ca6d776fdcc37b0f0ecdb3f0e993f5fbf226b6a37142677d5cebd8490e036d854f3bed125e7af0ea71c4067091fad156e3e641072a69fbe98cd7aa3d56511fd1d6b9d94ab3fd6bd2fbd27c90a45aac361586d57055c50a46f493f528c1f4dee4e365635dd78f16c33991fe70f73a840a7dd2d5c5d71d486ebc22c0df7ae26906cda685f2f5a0447610a499d052ad98b89f59577a5dd25839bacae4fefacbbcc1bb266cdfc93b70d6bef9b9e08403a114064d6fe86ada8f3b82d905f0fb826856f0f1d17d90129159b2c5f540a4580223c1f3846bba9b5f43eec7a5f3ff658d6ccceb53bbdcbc4ba1c2835a40adcb5a18284dcda96a70d8bb927d882f0a3a41190954d29768157b906b0db8d022060c3a0b1117ad62f254dd0dc973cbeb52dae7c08b3512daae1374fe4708a042111bb454213c4812a8f2af4015c2b7fba361cfeebc3d6586e5aece6d09d940938da7ba042b52b81693b78b3bfa0672e032506987987ce6c486b83e86ba78400a67c65e99b5a126dbce16cda6ea14757f6bf0ca8cc595b91798663b3ec8565079c9d97c61902be19ff6f1865c17ec70f8c6099c22a5b45f553d073b8e507d506e35c08b2776da660e8a8c4f7bc98233e7f64f891fc16bc7610109c9dd16d4f00b9fb7ecbfa763ad49ecc5b5916ba44855d4be8aa87c80be1ba1b39dceabcfd016d3f3dc23657eeaa07b0ef98f34c83920792c6c491b316ab6896c5e4d7adc4017e110d607c5855f260d2a03bec1fd67c916498266d2901a0c99db415fd6ffc0146372ca5b1a1168bbf6e1ebfd771b1998cc2d33fe1d0a9086738bd9054fa4604fa30fd48df295ef5dc89936a0849e10f476489cf0f2170ac026992ce172fdb0e24aa539900471fbfa4bf8e2852ab603ba120b4f35aad2e76472076a23f2f950ba1840463d491d088095c362c0152cdd0ea7bb1e58a44da4cffb7d61161e1e9010d9dc027de2d0dace25beeaf4129edce6ec20daaa79c6c8758ad9ef5c7175302d622fb4305bb083854cdb51aba6a1e3e7181e9b01e81c80de7fa6c78d9e9e001258ffcaecc543c97d93a0a9fdc125a9f92526e0a5e4b4aa687ea2baaf2e00101cdb6bdba99b440c1ad84c1436efe3b29bc97995ef61e2a788e169d055a920104eb520a778650d69e3502137f257552966d47ecc62952013227f0d8d0a40355020da68eb420dbe5d78daedff5b5dc7780925a2cbfd315600e1905a135e3533f015f9cc061ff575336fad2c1daeef1031670753fe8fd6fd27eae41ed55d25b160363d67285cdd285a8b44cfbdc48b96158ce47cc3c9d6fd87f8017682e43e34f039f94381718e8355edce85144dc3763d2445e173a16fe20b3866739d04b279a000be45e3bc95e5980994028c958f16cd9662847fdd1704c2590e0a9717a37960e71e872f9c8f8426f01a32b7f680a7ee1144c8b7a2e2cf989627665f3ce59440c9a7dfda0aef917a266e96cd078a71d77e4ba0300cf5b85b5ed40b4bcfce716080b7feb0b89b3e4dc1bd8aa449836a182f1db72d476b42b71440ced4ce1b23c0f7642dcdd3c2c1f8a2d893d699249cb6b968f84eb099699538ab827dfcb879701a96b4ad12199b061a91be8c81af5c3647e291f85ce9a747948c23628527eb001ecb566823b63ebb718b007664e0131e7edabd1a394f400b20d6e06de13142d0abf9aec60f4561c70c33487e8a36930154cfb5294757243538e6e865eb551830239e97bc1d9b8ba3ed39cfaa09683e8e88bcf2ade6a167cf533e7fda2efe0cb02ba42283ad64be1f9aac4238e82b9f66c953d29cc1013de27026ca8a1567c9f00cbfaf3da8c99447f72a69ee4475192b4e556dee9bf41918bf60f63e985267606cc40ae6a9cee809068faf3276f7239576944c462abc2463af7b7feff4f708602760d79c168de63412e64ddbad6c30a2a5622c89e4cf09250250f609295596b0dcf64bef75f15eeb4e3c16d06268c1e58f4795645cee1f9a62ac518774e8d1d055ebe18202c23be08e3267e3fed5be65ea58722b57da46b24b2590cabac649c0933e87c8d36af84eed20bcf4e8db4ebef9aa22f46f0a14ae3e0afea2f8d97a10efadb3790e887709447dc5edeef33488214d12d5e47b1169e880490afdf342f08f5cda92c868cc518394e7007ad2c61dae9a9c60fc87f54db036db651fc383a053c805f45cf26021ec1d7c5bfcbd5a91f512ab9404cad4e1fbe0a507517b86d0018a0007ca1318aadca98457989e5c48d2ef37d056fc7145fdd97d5d319f80d00246f7223ecb8cda197c5d57deba956ddd6d84189e548e788d11584d3038c620a6434b5baec268d1a86dcea1ce87b056599673e67d9a5154dfc32552bbd9a08084c78461b3776b10bb290ac8b31103fd4923c73c1cfc40284aa5a58d8f92c2e079c8a223033daca2a053bc1f797ad48557ba6f6d9eb6e87e72b46e17a4e63820aacf1b6a41ade0d8c7c408fb28a5bda64801cf5f88111217363ed980f5dc899099ebcd3e17123ea80461e32e5372394c424fa9f1c4fe2a4108252bfa80149d208c0db732949eb218c4e65e6bed6f934a6ffa975365aa2b871edea35f01ac54b0f69e87f8d4c872baa996e6f45fe08baffef192e09164228e7f4d0999e2d49950f3a46121e8e85e13684881cd4d51a70f12771a46f3c23c3d3eda7a6f90ec1de0e64aeefb5679323bae3e6fec22ebd4e4d8311d641c5217f35db9a96bfc77c130725f6a84c9085275fe2d2c5d43bbad934dcd69d13afcb94eab851fd6113f55801b4ea01b2bcad102aba824bfa921a43854e937d088f4e18da003f64efe02f6b0d1a1ac65073c41a11b3e244651500512fef5e868bf3ad91dc71aecc8d1fd7a50e7be04c41eaf49a1fd5335e7b7e6389d83af6deace86aef87beec91ea3598030aa33b5e6de4017cb37fe3382bbb55c55fbba2e6293c143d31492d8cc06392e2050231d5c2eca9a8fb8fe0c330e40a183848880d81e71acaaeade586a9a77aa00785d68b19ce8857e60aefade468bccb68ebae6a9f8422c7380dba438be1202207fb0cfde22b48d962e4ba38802c5caaa940ffe3bacf092d06f1584f7b4ddcef0930415c6fc3156fd7228e35b5143225987ba0024c75933ecfa377cd06cd7aca03e5cad79f7d70c8e5020b4df6bd6764720c9788e782cbdc7ad3282120e337ed0137049a2d8ebd66d45787f63d4520ee92b95d6a9e52bb01d5741e6e5f153e0e0d1e10e392847f32681780ce1786b11d606d09ef5864b7f27ecf69855f59655d07152b7fb2275d057d8a50102d0a4e666625416bc4c45104b9fec571631da03207423be3878eb87813dc8f600124abb3b814ed82e468489cfe9654bcbf2ea6b20f75be70fec085f449980397cb2af2c10b83cb8d92dcb85a5db609fc6de67e3f09ae67277d053047f1c1ffb6a0965d5987618be1e1b7874d58ef757853fa1f310e834ab0721664a44b1ec7ba810ea4f89c86055ec6ca033ee8a51021486967e409ef4983f308e8baafeff29f51462fb5b0156d9ee5a4c06b0ad87b7bb52e189201b4f5eb2899a7a2c2ab6fd960853021fe3c19323c5311176cd0787eb01c0c7b05c77673ec959cf30d99fd3a534898edfe3498048a05c2ea42031abe50d0f6fb001c210e039d082489c09f328c20fa6b66658d75a350e8171131dc7fdde019650f7089c7605525f4e11f2511af16fff3ec7f18edd5f63f5f2c46f41f122328eb023ceee30a28ffc1cc1ae0f8354e06270c69308085dd25ddced285a25c15c38c049bad9428c7389b59f7783ad982c44652f4ea04880b80ede336f21dbe30f09c05b1af21317479f1109067a6f31bbc6d86c39b91cd393ceb711c7f5f9546263b0a00227934721edc5dfdca83fdc281ef2a2f821fc007e584e52ed6b750457a850aa2773afe3c972d06a19eb05b00108be79c440b6bcb56eebfe297d566cba6c702bf73869a26272b1c0aebf5494e935916275c7ec5bc13f30caf1f6fe060536b01422e53007036d1d670fffa11d690844af5dcd5c104f7d370a4b2e613638993036c39f8b690b6b1a7cf956c1f5dd219f7ff13a2f8aa1a92c2e04f67959de50f0b8fbb4a5982cb75f8d7884a6629fd1b7c79bb589857c6cad558fb621857d639018674fa8d116dc7bd99db3eb42e733d04791d68516ea9eddd99130d6b873667027e7f0c91ae95054904bdbb8901dce7ce77b45e4a3d578faf4bc97379fe807a0416901bf077b54d922efd6e0149fa548a1e07be332832803e85e058c19c119206dfa404edcc8ccd90b8e39d8b7853f31eb8493204b6c77f266822a8a8c3b36905148b731a1caf87c1c66ff8646a3ecf3e5f6fcb50873e3b259ce974017ec3c504f98a40ec47eb7d834aa8d53eec9847f16b6897e480e3d7f7ab077d424b81c50969a942db4cf530f472afc8ddb8f6bc3509e91fd24d9e626ce86359e465b7de0095ddb43379b822d232a00e4d4ea5413848f7b7afc8848622928d620f4a0f860c27cbab1fd8e75777f2e81274200c8a69271355daafee68f4ea9884c20ebde103cdacc709a58b29101911b09dd0b80993cebb872d76c074427ed86a767c42230a29515baba05e7f32bf2b558bf991701175a26b5f4b060b65a95933f1f80f4c0e5ba95b354ccbc33fa4088806d9dd6c7a5768f23f12d3652cc1075a5205201202abdf2ceb4a4d1789030659953329fd1d1d27607728a7f790c58bc241b01fae00a0793196900a5b9fcb20c376dcc2230a019d34645cc966d542a575d3c164cd08d0a7b1aeb00b0311bcbebf37e1839af6b9276ffaae415a3654fc31e3772c120375f262aaf55fad7512654545a926e72612cf071bf1c2ed5548bb31756de40702b16ca16186900773dcb25e9a3c791c53d686ef08ee7049bc9a766cbbaf79e90683bb1e551ed52f32a2034dbe169e9be354f0ff46c41fbe93b8b68dc2451de30b1e628f6b75c7e943022a2e33d4aa507ab11f491d958c8693045a6fdc55f6c9029f0302e04eb0be4967a904332d860a2eaa51747641853189917143f07f3f010ab132a7a3c3c0c53ba3e68d2c8972c44dc81a92b605dcdbbcd7404cc8f76aeb0b97223b83254de07c91e4038855c59de23b465da72af618056a477d35e122fa0ad2e57af66cf0d80c120a80ffe6fcb2a97fb71b34789a337d5b3f27ef20d75807050b11bcba1ee4c0001fbd46c4443bc8fcc591202a5cf1fbaa2347ec4239340f1a6fedba55a78b0f7779aa09bd9eb1c92af90223c19793d8d83c2e08d9c8ee04bbeb792b6550d0e868a92f92b891682b5314457f196dfca49688a70a1be7b6082da097dafb0461bb22f68aaa4607aed52793e7b525f1cd70c0817b4212c44409cdac10beababb7c5c8cbf9ea6a06edc8441f3a0ed5bad153238e73572eb0f204b4fa057e50c708c6a96556f19eca5e0a78576d29f3a4a8e1f77822f56650910d962e408e8fe7d49eeb0fd4325b439756254f3c21a757584780d733c59e9aa20d54c3d5a9082bff74994c61d31cdb4e0fb718154384073e52bb7677b1b046bb0138f66a714bd167466f301ed68747a2f3c4fff70550e24112ea5643fa2e810c095bccf40aec062d9327c8877aa68f5fe6fa70eb9828be1237c11268e4797f624a5fb6200b323fe80ffe383e225cc1517102b82fe56580f629b6b3318ff23c48793ee2a2f4f3e9a300230af609d881e174321c37132d03e8367f386fa192be52e43998cde760e6b6cd805c1a7a3e7609c4b6f3ac6aae7d9f6ff04cb8015f48f203299ce5aceb239bd17b91f0201939303c8ff3ed24af50b9f38b9474162cc3b25c6df8cb967b88cd1610125b94b2bae4b344074b607ed66894198f5d4ff11274c11d898d36082d4bb90bc5dc517bd0da2fe38a66e78826c4abd94ecf68f7cf88c70600fe89dfaf27ef8ccaec95b256c8b3aa4874b53998bbabb121d214f0c744fb1c30569a69594a002ec746530fee1c8ddb3757462c9c6b85828a39e6375fe2b806e916e1bb53138ee25cf827ae438c1d3d660f8420023be71c9aa127a42fec6026a5115090fccada669f79985235fccd09b162066f1033d60b796624b8dc821e9e72e1dadb393c30e1db8085ad2ef0c8dbe5bfeb35702dea45123b41462409aee464ffc241ac49b1530c038fc0a46410574f26ee2bac0e24a15ca056044fcdfe765ae8d0d49345e5435acf02316f47dd5388076f4f009e4f608b2292a224b1dba1cfffbff89297651acdad19576febc3bc97dbe3ee06926c30bee9eb98bb1b5422b03028b1e6a2413533b7127c4fb218959601450b9fb0971ea8100d039a6ee1611e7f3181aa839058a32a5847a1649de7a4d33c76ac557d1631def7ee8c2c5e5062f43c58ead55d1e682b571a26cebed9c5365bcb532bbc86407158253d738a62c78d2745f9588028a43c43d2755a517f4a9a5bb40a1106611d9bf1f323ed14a7112f17a1ee51e1d49f1dbd27e4a67e4b71dee70bb98ebdef6cdcbf17f7875530b0e14ceb584dd7f311bbb3d204ed311b0320eb23d02c6c4fcccb6bf6271de31894a994eb9fae8bb8b589f978ea48d554fd0fdb9dd42950424f243dcd4f0b1911d5899518424de47baf61a5e23103c1d2cd32e2079f42b000e1c495f50cdf85073f44835760a8d0dd33897d1dfd30c10da29566fadb12004565751f8408380f2c1f555e20fa105361dc6a24ca712f1dda4d2197b0052a4322adbab9d0d82504d76489297ec17c434d043686b64af59d34c041781c124e56815ffd1c5db8ba940617a0b0784d567b6ed50d67b9fbf9e59e5f7a20ea4d3e5f7717dc7825be44f1cddf0b027d1819722ee83e56bfcadcb26a3734785edd25bf8c3df5fdd9b04f120fca7c89a6237941c19bce11ca77313c0420a6492f0468965ca63eec63a2cd56fa6920f3e8deca654b9828d5758b3359cd23b2dcaf8b043fc6fc4ce7ea2d760b1544a9bf7652a680b8689eee2c46134e5ab63b515281bed07e68360cfe49cfae5317285fee6c8c0d6b2d88deacfc853f9d1be8c2d8b39b139297345bdcc45d79353d7ade0318896d1f83c318b53cfec0b2e1338ede9527ac0cfd6f98a01fe4b64849d3e5f63b2fa73d765ecdeb3e80734aa7f5d0864a4e75ee913dabe32c01b78ebbb7ecc03a06d84128ed019e2531bc63cab71e413fabccb942010e4a237b7ed7e5728b006499c639bacb85ac81ed3717609191c156da00de7e6b37463ce8d0e2197953090d34a96f768b280f0aca985e16c45fe5b0344a9397f2775cd232a10f46fc2ac50ed90ff438047fab64c0c18e7b0fb4dcd256a6f8f7da412d06b9c48e61b878525bccdfa7343797d03db4fd8c3b3886ee5b4645bc32871fce6b819659a430a210184fa83bc2232c1cdf6b9a2562f470f293501d73d7695322fffb02ad15b429875f022b98bb7216a472820f25679d87a0375dc1269100f1418ac249802473a17fb8bb53d20125f14549e52626f296efc9083aa4ca65e8cdfbe17b87c6827c21f403361f94ec8cf00adedc73e11cc671d478216ce49e0c045de3a2932362981eeace300c596bffbfe5864e4e8b907e0a2bf4a9d20f4e3e46ca71fd3db4764580c906270ad5bba0b172e7cdca531f2eb9223ba7358beeb8c5a566e48b9857cc8f84c8a16912af4c3d625be0c34bcde41f3e5a20bacf60a12fd760e95c159dd6767d2653c8fbf9d2a95aac93d2bd14cca380a367d7a6b5b12c7ab0aeaf7f566185ca398130ebecd49c0fa9df5afdd91a06cb35ca70cb8ebb6042d8bc2d2650a71821b7b373ec71e99e4867b3a7e03819f2ac40a5effd2d17f3e055fe1ea8010f2d273f860a4cda3d536a762db4cdca07441d392834504d0a3eee88e77b9fce91b86aeda59b63414ecac8090ef4272b4c8b465932fd950be179ef01b5b73bf43b741c8ec8a0be40041108a6c6f9179dad0ff8a498680abfd12eeb75b37d3225e08338514f6801ab7633bbfd09f2495c14c7c9662fe59e4d537505754b8b8d3ac0556868d32841b5188e7734645cb8de886cba9c855757bfefb12a2ce9824cede8bb36aee547525d4f6ab6291b46986ad222937d0a8b54ec0b57659c200adc3de059b39b07f6ec4d91eb85594d34b00e73c683dbc5ae33d9dcff1a0b33593173562ad009ea3c628eb7faaff04d5c6ab779a7bcf59d5dbbf143e4516aba01d87fc0e2fa996bc952854f3d3be7d598a725506331599865bcb985388e9d68c85e734245241856986314440233bb3745c2066855a41662f833fdaf02139de8cafb3ffcf9b237f3f4525f4d9333bdfd58973c31cf77aff039f907c41b5447b5a3b7e0e26939c1da881542bcd22e13691c487e6270acc269e4d071732c697904faca6e5834f2b3bb8fc58843a955fa6cdd30341c0164742acfd05c0fce288c7ecebaaf9120bf369d37359a3324403e87d90ca1ec21426850a9ba3d7b09f0fce5e1486b0cad03239a2aeefcc873f9a12db99985c476361c32e64eb8c88e851fdef9033eae7c14d93945d71b7af1b8f74acd508d3105309f17e729e45d57c2059f012213d3a5ce6076aa18ceba993e45ab8ea53a6a8571d360eae67da7dc9851d406ae4921daa83e5d7f310b74a0780bea6cf7c7f1724d3535900998939ff91a3509d76c88218313e2536e34de70f504d74740f8e2c8aff5e3ca034314d28b1db50ba4c242a456e6a22874aebfd178aedd34a046c40c6c7480bc7ae0135ee9fd940c88c32ee8ae94b61dd3a27efaf73ee7699638d89743e7af3d2acf50062d670f092ccdce8060b8d6e3a6c09cef6f8a61f7275323aafd0488600fe9f8a5c6a3f90ebf5922685ea607d73130666662c7b57ef4853635b2b6dfceec747f603727510ceafb2b2ebd2e552a26c155eddf997f5c564cb6c5016670ea24f2170bee1f570dec4fc089ed21a091503414d94777d5630c3124e8f632e7e9ec75ea851fd7860af9d3a2ae52abb59f3ba02b9279b733403a2e1e542cd9b8d634f9135a0785dd0c29aa4b29ef428d923053255ee5b0985549b5a80e064f922d10465416d8c61a045aa92a03bc7de2341483839c6cd9c59eed7c786575a0f758a6bfced67c345409ff9910271a350c90d04845b180a5ebf19ef67e7d6b0883f72cbdb3745a32d70dab89086c95c723993ca5338ebcfd38c12a8df7f143c050400e0c49895f2a600a834f31f8a6a2f805f2a02fe4465daf95f2f7a5ca20b67a3227d1d8273124f201b108104bbebebb9f5233ad794a3485a688456d82f9ae9598915f863f095a2d080be790eb8fb5de103d043faf16c47596709b5a70024d4af31733d06f841e180d7903ca0c04c20debfc5528cb7b031df7f711dc5a2851cfc46540c40c592bbe09d73fb7d871cb55b19ccfd085806c709d4228c422dbc0849a89130fb40637050d9c1779068b57b54707569d04f32814e4ef0aa9a236a4554ea31e4bb871ee350ed6f95b03cab655744fe4d77060e735dbb38d4c1b7da0cd4ab2b3deacc6d16004ae81eba6fcd428f7bdfc1282597b9d31209aba88cf1e2e9fb34d5c6892bee909d97f4ab7aa1d2d76ce0ed70d0d353b0ac6a3f33fd7bfc97befd849dbb459560eff889e5a59d3f128435d984e1cc65fde7e64014b2708497abe1e227305e5a80f774c92193b4cfd4babea5cb8d35d7468d290026508981e9225c1392dde0c4b0982544d2452bbf1732bb9f5674ac46e5a42fd38e524a0d3332e3cd6c3bc7012070c19ec1da7b3ce509036ecbf2d57ada1205c66eca3824a7f74268188c35b9303e521a8a87ee70e6ca64080de02ada48019ff7009db4dd4e6c36e7486a414c50816c72647b90e8a7d3ea9aa15741466a6b44ee6d5ada4e9da0d4dc1d2465ffe0fd7e869e27f237453e41008d732d943ae1406e3c31f57febb9d17fb2b7f7f1d0715d73562294b1a99c7e56cb9f819d9586fc6690f31809f9c4c46b36b39303600ddb6479c95cf28c1012fe82c96dace635d590a4efc037066edddde0c23d33a05505f5fbe521ae4c3b257449c40ece2b5226dbe293913fcbc34a4506e18fc550c").unwrap();
    let tx = deserialize::<Transaction>(&hex[..]);
    assert!(tx.is_ok());
    let tx = tx.unwrap();
    assert_eq!(hex, serialize(&tx));
    assert_eq!(
        "a4731ba4374a57eacead408c2b28716847998a9b505f18fb759449a2a6d33773",
        format!("{:02x}", tx.hash())
    );
}

// Rct type 3
#[test]
fn deserialize_transaction_4() {
    let hex = hex::decode("023c0102000a94ac01a827af23d405bb02af0176318c08a40163774af4f69833cefb09325583437280add46ae7c3cf33d1de1b082d13ec2c9602000290d7a1e34d2c196624913a667976fddde00e5f988ee4ff664e133d24e26f0c5300020ecc98eca9e8a35c713b9004c5378fa90f13e3aa7a99a7747cb0a4d66f3e406e21015e1a2564e81cf4a81adaf0fef26e2a50d83cab84495747fc9349597e46ab802603808ffbe707142d1ce56d4406362d273d7140332e811ca1f6e6718f07ede744db88e3123c01848066db756f18d1197c42aabd35c6bafce871dd7df954a37041e330d83cab0072a22385b593f4fd24191e05c54ca96dd0b0d6a324c858f9209dd8d177c08d04b1ff1374901283e034309e1940e4730d89f1193d5e0b756eafb5994f4320db0f2f1a5385185c7a2b32d3e2436b4eb628cbcf6ad4d1859f914caf9a0302ff958915f264c4970c86877db3f99090bd0ce09c3360b6fa0e16dc046e18fdc109ae2959526b224edc34fb1f36209b1878fde5d5a4f0ca5fc3dcdb3ac2cbab433bf7ac02bf06e3646cbdf97cefa7bb66510b89ab31a65ad52345694ad000340fbf1f1595a9b5fbcabe7f24ab0e63a712ff28108200912384c46dd8a6f92bb111ad324c654a6108046f9ab464686b1775e496555cc3b5db55802d1daf4e0f6ce8108217e6643c084a402ffabb56fbc1b05dd4c385d6f76bd96d8513505523f9fe0b6d02049ccabcc51c7ce17625657361bb18b9ae4d7f53179f660c3e00afd5e1150a0f061608c9473f3773d53be22d26ce70cf52c1c1e6372776b35c8a23d66dadd2450e2333236114b3fe440914acc2fbba9c263b43a2ef6928d6037eb6a624467abad28e2d02d420a846bdc3570dbf76f1719fe29933f40edff6c517fb97a1dd69abeb6818b3e120f8863c3dff2b5100c4c9e3f9c04f95ecceef223f9a9614dad21b54c58040854080a052e53fec4982a800f0262310d5e15f8c10042f0992100d4dd611e006c1aeef08205d73946dbb2e4db71eb4a3f4a38d26a04c9ce982753c3d77069c03719032e2db70489d1a42a1e7f38023b7c9ecdb444f8641268282f8dd2ed7e96a5d5c776834813b188fa067b4f48c03e428e8491bafe05bc8544fd718851139fe0ab78547506dd7a4d70e3f1dfc75b05de9d762fc021e91caf917d61992a3672c4d8438277cb690a42266592e129f6c46569a12e8689badd24977ba674e51cc693b7042b9abc74cc8ac499a4db04962bd0209d495afa653aaf5d7b8c88fe7fa03f0e8e52133468b4acf88d439b391a7079acb8aeba24856fc972854f96f85d80ed0f91cdf960e1218c6775eb40b26f6203b1af1e744df882b71799999120d011776f50be7060daea903ef794cff3f61b51493fd11ca4c0dad71e54528f5012970fa9c3c67d455de6a302cda4e32c8d928c6e3897f5c73ac318dc3391d8707181b875fae9d7f8ccef5960a866caebdfdf311bad4add505098a15cf7ad678a1b8dc42705e4c8236ea776593ccac5941f4c432b32528a0230304fdf723739d061299d3fa83d0ee5f92162eb0a1e63ebcacc0a6c150f766c95b4d2687e1d5e06cce98c29d48fc64d3c101d53bc58cb5592d0aa88e347162db7379078c926f6ee3411f1abf148ad6becd10189a630357d07e0594ba1caf7570d9019fd8c313ae040ffe493faaa2a1761d1793084861fac95f0a333c22dda5fd946fed019c425800067567d53022e42d26d5492c7973256b0622f4b99c8502329092530ed70446e62adf3a3fe260da942d52c97bae906cf531ad2f037b3e291b5851c5cc48c6fe682321e6caccca971904b78710df289eeca33dc98de00eb475b31952341b7bd087e1f05511ff795b46e6ec70a7c3e77ef7b0b0f0087ceee860c6b9d4c0a44f9e5d71b081bcd3d242164b6d8554f884f7dadfa245030d3951ced7b9250c694afbb4bef439ced8099dba20d9dd94d4deff3170097d95ea5f57bf435da3bd477382a20306fbb0d929a60a097f582c70baf5654aae0df6caab7f66e82b7674c56e73a2a53c279897d3e6b9b2c2cd5052b9d68a1ac28140a599371c52c9f43152426aab386c1feba71d0ca1758db409377c7014ff1b4cc4282cf930e5e4da2917c59388ce5753c7f4b94f029b15f4f647318c6984fb82d44d53e329e57fd6b014f17f64028c71c41709dd43a0770a5f71bbc7d2557893b36779973b509c99b6b0d3af48cc3bed55ed9b43b8c2d16474280b064f85328bc432a8a33c5a93175bb3eb17a977ec6b355d05d77faeed547f481899a253c174b1b71371fabb23dd4f59e468eedb07850f6753149739beb547a64035044bc796f1ad16bf77919d246642f717c2e5082adaf2b20065c6b65cb7cf2133117934048d7bdef6d695fc77bc6d5c26fec007cc997e25b33bbab18d8dede58bd5173ceebb4b30b80b31287bf06705620c6c0aca318181a8f554ed249f34c34f5e5b3295761a1c29f6b00a0610733c2b2af806121969e49d002a33c9e94e1c16cd78b59ae9f711ee4c77fa84c6bf9507168804b9c884a2d6cb038422482d80097d93ded7e7a973c3138d7a307ce5f3f0d9d908fe43524ce06b5a6b3e936d0de7e51120deb5e285370abb02b7a2ef6770d2e504528d6f958055dc6025de512063844d0b2ded19d73a4e9b623933791c7c81fc090a43433c4006247746f56313d12c94219e9c5252ad865a175cf73bb47fd9f50c9c0f42287358ef6321f8ca203d47148a87a3642c45afa731381f92546225be086743bc61a27e76ec90cfefdf6b9310996abdacdf1b37e2c68bf66ee5d25c030ce024d38a5136ba6438c5c34cba8eb580e00566689d7d624b2fc32ceecc83e80c6b858bd26bd274dfbd90025dbd05c4d722602379b868a7ef0a2d70f0589123021484faa572ca5440f63047dcc5c8b43e1ce6995f06abebdf6e80b97a9ff8200ebb29cbad0305e8dea0d9479bf2bf12cf757629c4229eaae802dc39a37b180b07688ba8f627d8bca0dc1a9258a719509444e9b4eb2fb15f5eb9b724455d1a7d00f3ef8ac84b89b2392e172a8ea375a2a1a43ea619c1196187bed8435490be8c0dabd4f610c462160a7b22ea35dd4f34b47d777b6ba2c926ccb4dd50396f441d0337282892d380a42bc8877346fc352e00734d2d41dc0d34e9ede1dda961ede0027686a00aaad678f46e2b37b21433470c07f22d63dc0bb0b29069decf7028ed0c385a4e5bb54f48c4a7fccaece998cbde8317173d3b3f713839bf1d527aff8c033e4963552cef67db6ff0ed898f16d9ff60d0a0aa9f2b102c91202ec03c1f8106ff741ecd0aa5f1f66fddb3549e2579c38900822e288d48a34bce383889e2d808").unwrap();
    let tx = deserialize::<Transaction>(&hex[..]);
    assert!(tx.is_ok());
    let tx = tx.unwrap();
    assert_eq!(hex, serialize(&tx));
    assert_eq!(
        "f5228c2a18bf98fef16c027f0a5803ff16c0df178761b9cd110783ca1717d016",
        format!("{:02x}", tx.hash())
    );
}

// Rct type 4
#[test]
fn deserialize_transaction_5() {
    let hex = hex::decode("023c0202000ab7a4018101eb319908aa188006c601b902f60677774cbd617ac00f51b8446a86959e853b4f9f382b2d6223a0ddb8fc936112ff4302000aa76dff338424d93477bf04f0049d0269df034dc2eeda2cb393bed53b3e1a4f127abbb952cacd6de3a44c45a705265e5ca7e002000217af83c83b42282414bfe11ce2b99e9b107bfdbace16dc9719c4531850af46b1000270243d3e247f07c5e46ccbca133a9cb773dc534f0ae65a5837df38b789b630fe2101b23f5ace89db241c5cdeeb3d4b3b0b57acc81c17018fa98c9fa51d6a99ff31f904e0f4a3b50a7963f1401493b45dd218e681ad2553fe80b26e62b86df57c9bb8f90f7f9b550159f22d97fa8afaa49f43d0c2453087c76de378fdf0ca24072c5ca117d6b3ab002fbd1fa3def99dad67c6f3e535b34a0bf7e0380488cf494c79298d7eaa132e0d8ba93591e831928e1e4143411b676c5f1d5ec7a9b1113fdce1070a2f7c00a500fbf6e3924d67d56157c40418f889e47c2736b85c6fc6ba32ac9864966b866969afd22510b313d0751ce4e8901463e2bb18bc951fc6a18ca5d4ae805e786ef6452f75585906dcd32c12b124e0d3346c5b021cae216fe4e34d2bd894af86a1f502ac3c0b3f9b2519232f7c82c1349325e2f0e3c7b5973c406159c3b0466565f9b86c0da92441522b29ba14ed385cf6ec7eb75ec5d3ea66363ab510bf70270e82eb29f241dde6d36ce906819fa4e0865e7855536ce3d67d40bfe27f9d32a2aa791bc52fc65127ae873b4ae9a2a91941aca855a10e908a3c15e7b768aa7d04b15c0d3324f289a23d3571c0bff5305224a32cceb9c49e0e592f2b2f78dfdd40dd2e070648e07716be30b9f6943f304b8657cece76d60d8f00e11ee5dcf971c7f1b0e61a5ee4a221e7eb9fd1cee9f84a777b567937024b387db04c236a9b23f5f98d778b2bbfcb3aba4f042e1a5444a61ce4f961bc8c4b286d9b6ab2763e72e4738f235e6aadfae9b7bf7ee82fe01654b965a96b24c874d2e14782550f041b916f373b095a4e3e84315169bd10255602dd5d986919a79019f7223432f73eea894a97c06695e5af2d4bdd832a3b75fdb56ea03d5192027af3d758a433962a81d429e5350f06d0624b66d113070b531c8bc67571023a08f4e891a957d085b2c05122d49d85f48709800738648d76601d2e09127d4bec33fa192d2655ed2b3f9214a14769d8ff68e33f9e00cedfe8e49489dbda3dde4786870a3a16b580fcd4997be8172e398d2e4f0eb20f92032f8dd58741d2e5156bd0d8c34ed80894df12f636e5be86df7e2c1d180eb70b81ff5870ac91897360e9725c87286997650804fd22864739a89e59c4f452d4afa4dafb48d476f8e19aaf64430ef7e7b1f9e643da1864cac31878e0799d3b3ceaa7305e6391eeb2043aa913035bfa3bce6027c0e685793d8b9707d3dc3a94228cad73f6467baef24a8b199134436c6839e4863c7f802113a3000855ea49f8b022d5eecfe56a691176d449993479e1f3c560c74b9b12f92829350c5a1bf8f838f14519601ac9ddf0d8bbaaf6e41a3cc5858c516c6a755dd630262872c1e39142dfc57ebb26bf89a69637a885ec595ab0937b295bdcfac6cba1f0f2da14f1a08dfe92fbcf91ff96dea016e7c9a04d11cb7c7ed6f57d0e8178b5d07b11f21985df815dbc7f359a6fc10a1f56fb426ecceb949fd9c8bd6deea5e7cc784b1bad9ddf3d04f5a8b875b90950dcba47b734f87d16b6782aa2826c4b7795060ef29a28aab75d2b00c404876442dea894343e7d95e4735d41d52f53eea397050635883dae8b97ba62be18d8c0e16a7204b3a4efd7cb86bb66e40abdff1c0cd4e8300759e57c366f79e929d56b59677418474fbcc0d93e68f49bfcd6daf71afae5d8a0c6f90d72ceaac80fc37864a9dc8b2099dbf3c94fa54914406174cfbc2154c71d5d392fc84d19dad8a448a2fab09d1f78f8589ad40814271de2148741d7f747c02bfe1cc9ccd511a9915f39284af538e4d8fcba7b0a32e6e3592f8881eaa0e57a7b3fc6d90502fb7e34c276a3f5e60d62c0ff84c5a607edd1a3ffdea8fb6806c228a5e7d5f324255d06365ae83ee642d0154bd555d50532852f108e4a86755882b92973f2780dcc241be9c00a6146cec0a8a7528ddfd07a3b74d6bf0379228a9a78bb37b3aa5b54a5bf441b610ea1f2340231a4e9d391151ddd066721237b4737cca36380c4c6ab2712286546a66cc3c32ac0d6b0312b59688b93fd0bb3b334b8518ddf01b2173eccdfe5566b4c17fa85a6d5d968cb3a9540a9336f46c41c2bb8a8bf3c47e535ddcbea03016c08a11915bbfdb40382e6b8d49b606e51224dc1d08fc48985b85fbdf15dbf3e0ab4da5b01ec1751151567f8a59f24c1f6111c012c38e1300dd4f734c45fb4991f4ad66d60a3f26a00cd018f05e144dc95dc6a01eb7a5a6473da0fd474ac5766fc286587a91295d5ca0ef2c5b1b9433d712d6a02c72a05b716fef6ccdbeb996d469b6a23036405997cbc2526b896fec9d13e6705f493f85936354e72f3c427e61c36dc37256c73aab548e89182f3cbe01a6f6d006cf4c489bad5abe0e5ce0d39ca11310a5022e7e389b3c40b56d0fd681841f60045854b77c409d7d764ba0bdc9726d3162ceae5f3776523977ed4de054b9a2b0659fd24d970379179296ac80b67d5d4321120ed6ffb4fd7c4c66f6383fb9ea10a32c19303476abde0579f80d8ee61a12136f266d88a695a5ec9d330416ee491097e51049a36ca86e25247b4604d8ea9aceb40f3dc8e3022d10352e1d3fc7779099294ef24065aa6ceb63af4e04d0409ee5d75bb3c08c8745e195df557007cd508e47e52ac339ad5ec8c464f91fda015102b246a07de83a412e70aa8806dba920212b2e469f0efa60a64032994b21989b36e3eda132073226badd9c971ea5bdc03cb589b5444093c0a023e7205b2644918ef438fd2bc5ec73b2517c96f0657e10add6a7c14f3291eadb82b07d9c5e924d1292d51f8ebb2f3544a37cdec9fe7940f96196f15e4c862b2b9b86a46c588cb7da19670ea83702be5f4eee269c75a1506e9b2304d4eac4e3dcc8a3a2d77b58bc26166e8cdbbbefaea0e15abead26b6d08ebf8ade66e2f623b30ce19f327ae80e3397019113547132ccefbb169f360340f862c243900a80870433ec7b99f8afc58d8e727c9d8f6aab67c206cb810769f0ec0e0c1c5cb9565ef91f34c150b11e12f0f54b3f856ac933bbf65ed5ecbac1207322d013e0d7c713c967b828a12affc37f42b4ccff2b25137b8c6e12486957c00eee050afa77fcf702cbc90531d2e35e3345496232fc48d3a9259ac5216af21049e4961a8a0c29df7bcf816ac2d8b3d2ea049c32da7fbfecf724ab695cb123e0033c0e860b2f74f246fd12755be507205e18d5400f7278baed8bffbcb8ce24f066b8802df4ee7850ed581399883d0f278c5cc7e4d593becb14465ede55bd31802db03b21843ec312a4171e86ac7213270e44e99b0e77fc3dcea11ddcd086cd00c0e3ace9801919242a535e28dc37c2e16ef617199fb265e5421b0cdf692dbfc011e694032138234cfd30b205262acf5d68b3f641e411d1955c0d164bade2cfd0f79059850d3ee8a52ba5e7038116593c9e6f0eb67567f990a519fef7ebeb6ca0892d1f84a2df1b68616d81b4472857c78d62dc6c0475902a1587dc249ab94ce0c56a0062c92a16f82956d8cefc3785e9b6bfe16c41bd672107bf4e53d909f9d0a0cc8737810c76193519c8094ba326f1e33d0c2a8e02809fdc89dc0f672821d0dc5fcd8d9068e609c994531a6114d69f4004f14c84dc8030fc67a4ed9d2c8240315fce47d32402cfb350a026332a0c6b3883831a83c87e746f496d01796a1020b87b93877f59ee99c4c2453d0d519c12c4c05362e382998cdd5468b2680c999026f7f60131d27ea5240c2fb1ecbbd23455dddd47bcffebce56bc571bf0176f005e0ca2e5c1e910d6c8beeb475534ea18b552a3f8f707484f22d84ee8768de1c047718be212b5dc6ec9a4f348d415a16ac6eebc205ff5a9d1d9d3be714a9e9ba0bf0025533c033deeac62854b4d8b7d5e759bd4f1a03dd5fc229abe5c327db150e3e76569b4e37b72b608aeb98dcc4f63f7fe1badb2a97a3eeae635d8506845c0a5eb944e6e49c1d31a45f8d4a86180f2805fb50ec55779621fb3e55904e680604fc62b2141ddf2c9b1650ec9a5090f44ce38d5dc2c66c5e571a0f029012963e07b3ddc141ed4f37be328fba49e4bfd12ad1f925ef15fdb6d05599243b76a807056bb9d261c615ccf018233ba5ab51daaadeaa4fbb63067eadea2a83153c0f9a084963860312a9d89f81cc2d480fa0fa1835c91493881c2fc23fe0898945ef170572b2033658b05a85976ef70a05d7b6e1f229a6a2657328d89868cfe4e939c35f5e850f6615959328ecfcc2d73d5ae5f065cc94db239ed85b26fb070c38e51b3c").unwrap();
    let tx = deserialize::<Transaction>(&hex[..]);
    assert!(tx.is_ok());
    let tx = tx.unwrap();
    assert_eq!(hex, serialize(&tx));
    assert_eq!(
        "2357832bd6548b8c80ec3797dde8222d5669462f666dbb65a964ad6eb5d202c5",
        format!("{:02x}", tx.hash())
    );
}

// Rct type 5
#[test]
fn deserialize_transaction_6() {
    let hex = hex::decode("023c020200168da217ad029b10dc04f204ef0ab503b70afc0684049f04129b021171c7011b0a54020f0cf84ed81a48e77fe77b24ceb7380d94651bdd6f77d10098b5694f6755af99be4d020016aba9178607e605f6078004ca0229d20b9701b8098101fb047e9901fa026eae0201452e15498f83861cb02416d176a71ea2b31e102d6cc0503278de48083967488d37209db20200022c7109bdcffa390f950cbe1cc13b254a78fd57e2a4c2540ec5417e5d29f5efc100024483b5df1095b17e753953c37c8a8245f1f50ccf0db20988eb3e7311389b75262c01a8fd9c98d5c35affd259248f54ea677ab5febdf33568addcd8107e99fed7ad1f02090199f47da3e245c76105d895ec8f0c6203113494d4b1bf09d47fd178317196336a64acf720e820cba8d8e586d5b20f65cfd21b8aba7063c25656a6990a320083555323326c163f37df6fb8368e7d0975ee78a8363f4bf448091f1509a84d88092bdc1d52daee731201669267b95c0ba01f74f3f4749481c34a53103fcb12119c56ca28b0e4361bac52640eca91a40b2b5b0736a5a6bd3c2a45e0c70c3514e7e01f5f118928e933ef2b54a0e361987306aa2b33e6e3ea433e7d09020445cc2b6dadd746fd710c96bed017f8ab5ddfc40100000097648f61d5bc2732f247eee4cb73a4c5d906fb5df02eeff399d56f776e84c2fc435062cd557c296ba5035d050b1c53d61d850fc10fed3de7f21cbaa9db7bbe983ea3533845988b83de2eb64ef0c488b46a841bd2074678bcc4bb1ce5eb39491ac16d4265b58d7fc5826294b4387d76d2cfc46b37641495068f3c14530e0bcc59377ce1928cb0e2ed10ac2d05d8a5afaf0c9afbb2137409c8c12e654e8aacb4046686a7d533e0dbbd08a211edf4694d0c3b4179380c844a1af360dc384a1fe803072b58ad81bdf3b2077b7d3c9dd0e53f86442d2e1edb8346873a3bb904ea089a7e6c7cba1f7c12ebabb8ba2a361c12313b1f59ee9105aa15c1d283ed5b81363340caf9c17856ac174d56020336bb195d3ed6fa6dab42af9d77db1f725dd5e692d589951caea42ad530bdd45825b033e2302da4a3fca67303d88441bd0e261f639b8a22ae54de70586ac1b7f9d2f0a9753b1d43c937d6a559b242f532d6b9d595da071915ff732d68fd489262a7024cd5b665f33318d3bbf12b450469b56a2426f62d71bfe756205aa3533ff5d08f9b4566b7cc5c4bc279440bf5c01ea275bdd4a007bc724523b0ae53903e93451aac1f9fa7724ae9a5330032ec0d1fcf56a0438aea8c2aa1abad60d25dd1eba6a918c35b0aa643ae8bb2354fa862b90440a2bce8eee07428342dc7375a649121916353c7c68d66cd449694fdcd7991d86bf42a104671db23457ea45883c704e36e75426ca82a799672a8b52a62b02fff4d64424018fb438c528590a92c6cdde359d85f441d46ad8f3e672f230e9583c1685df9669276f215282b26a59ef9f52c80a17e5e9896c83e2d8a4ca9bd887c55806092c1591318a497924dbc6ab545a569b76c86af5a186817c424029c02795ce9a8d20cb9440f4603fa041a226c1b1858a995f377c3d4a2f6c179f8d752cd713aa33f1c027d1066438baac33626707e6e00b03622cb954b33aaeaebe6c9865bd2e353d9065713de3f100e3b29c387dd40272bb4055af93c6df2099b602cc5735c6e872303a36b059539c91d1e715f979c16857f916f28b1cf46c184ab27332003a06fe902c20f9f9c9516bcc6b17526dad9c01f624f553d4d10614f301d20d13f709bb50215c26fe872b8d03afb04d273549e74b6678f8e38adf80d454d9f568f2ea1f607afe4847ae2f8fd5cad6c6d81727beebfa2d6a4452fd9b74804511fc82f211d0adad8b365734a59f5249fb649291240e44b2c51ed1c0c06622e1cad6cb86db6097e219b49eea8aa0ab5c92bfdc214a7e5c452966c231018ff47b10d75e1f4700aa0afdd1a0557e450c6fe6a8d37705794888ae10ec81f4dafa83727bd10674402f68e7ef4fe5c884e01bf7c573726053d65e918dff24012849947b3ec83681b07be4028b7649a78a5c42beb6310f659c4d65d795f90fab4042af49c38398bb704a1d6c538099e51d1b2d70d07e0a46e8fc1b3346596907119b0952a9f0bdd530bd4bcf81bdbbebc27b282b1efd681697f0b79ef2fb9e845e258a1a6ac0a18b9055c2e064e435b0ad0ae25a7df1e08876631c5a4f5de9abe1f02559bceeb5d8f0e0fb21c5df35d3b22cfa1b8084253cc83e5508f4852430edad2a68119641e34070f4ad4af25ef40b656b506492110d7de59d0b4af79b95e9b7ef1d58aab922607498f66509bda30fa5fffa85a1719ac3769241d31ebf003cfea631a41d25e420d1ff2e6594c1834cdb107e4097e6eda08b5d84cc182426f9f8cd2c77a301303080c6e5d6b847b983f91f9e6359f2f70167ac391a8577170411a935e9be654a504f4cd10a3acf769ee7b61c762cb0f3245b05c6b3cce5ce0062f90b106a04e7909f5cd975c13114928be9e7145322529068eab95367249b1be467ca844f846870501ed6f9ccb0c0c791026c37a1a4f1a9eca34a130c97163c3cd0c51f51b4ea50822ebc64c8272a240ebd9ab73fdbccf3d2fde4a004b33d3c1279cd55b98b46901ec87ae5ac1446a0b9a13ac16f629c7464fc5bc50692c3e2e6fb1fb8ccc532005e92d8d15b7544473ee71a34f9bdd88b88dba158603764184d333895db7dafd0692048e580e3a477bb319ef86f94edf280d88fdc05a598ce22bd1c3f6f4707a0bde25f17792c1d8723fee4296998fb0f2edc6f0e0d3003fe106ec7b95e1736f0016026e20dc50f2998129f7ddef25d9be52626f8632546c4760ad533b2b8c02087100f2342cef3cec77700d90611e9b9156aaf5d631893b7f435fddd1e28dc0039123662255f4bedef5d168fc462512c06dd2120a9054839747e6722a1d99c90cda4d8ba37f9b1b108299931e4d5082098eb71152f2deb99f7a1020e3b0fb01073610aa2c4b60fc61874ba177d7ffb95ab13cac5b3667523d0365212ba606d903b07a22b32c65b48fe7ebb5dce2d0f099393789dbf4f356a9cbed8564e8122b06bed88b27334ed375e0d74d79f86bb85fe76d90167f7d10e527a0866672d3cb0f74e8cf9e55994a29f7aae5a240300404dff5c23638f6e4754d250760b0e03b04b52cb64b3730a50fd0184bfae1edf333741f28c134bc6da1b66dde7ab75b33049c7a1c239640e2624d54a11cf0270bf54218ef649d91b231f1179f1099700b01d0eba400f0ff068957ffc4a9deafa9b56d81875e1343a798da8be54aa5170a0264474fb570945d43d02a850951c59ed8722b32f8b10aa71e46b0a9d0b1f6f20727ee17fc9ca35b35ac6277fc0a99c20080848b9f9c8ca45b9a9a26825ff5770fa4f503683a84b38c78326bd4438bbf4e9f80d8dab6ecbf7dda933c75fffb030cb7d5b5b6ea9957b4a5f3b57bc7b3198ee1222f04ec8ac470f0675c8495707400e896bc0b5d9ff2d683a15d5e2721d8088a1b0ace158a5080af76c32a79a7d10bc564cdbcbf8f4b1b5ccb79712e6a74c984bebc18d82005347ebad551cffc1d071bb822dad86cf7c0f26c524359137bb8585096cf45f9bfa7bf0d220405e09708836ce3a76fa427570bb3895030604c49823dc145469aef100c3220c7e2407f01a2187189239d9527f8a3ae9732839b2c7508b85be0b702500643780f0b5c460160688dc5ac120101b94022d057ee538903fa9ba2cc06703d2bd51e82cd520e049e39f6e43e21e8d46a2a7d93899c80412669159880b06587e0083fddfcf0080414643eac63e78c70b097fbd6167d2f1381483ea9ed96bb8e123cf0be9a23cc0b0a95bedd95eb66942e7f9012a936fe19d627bc63f02168d4ab06fa0761292105ff013df89ac88014406d44e90a292a771f4566a982181454de7909438ee571096bac2b656e9db06a073d410173bf239e3d75f8e5422b0d9a054b02b1e5f6c509d3ff8f9b352b601ffd9546a44a99d2b19a8fd6e5f3a578d2cacc6bd468971f0d8770380b6e448590ca93d9bc76cdae413e18f80886729e01258c17ee7d74770144241993df2277f58156079358d8abd05eaa7e222d13652c93b835797214780887babdad473d39a03d98c2433b75fd092af0a59ff02ec631ed7ac3aed3e0510a6271a0f63142c982b747a3bd436111e911c768aeb7b5a709bff475e3db016c064803a7e7bac118c20807d54d8e4ad3638b731a2700d53aa9eb2820f2ce2ff305ba9961ccf01f7297a00fb89ac68c7d7ae97c1dc782cccbc4b35c0cd46d5d2b08dd67ec508109eabe545cc30550ee2b4fe32d61ade873c3864060fae1d4ef21040ad5dccacc960ccab1a39741842d3573fc5ea66a9a62ddecad7828916382ae0bebaed77f370c110ffe01e1e92698e6abb92327f43a00d1794ebd4efd5572e306948baeededebf46a7492a4c67c4046c8dfd0f064b5e01ee317127017c7867b049baff1c4d5339f7185826538dc83cdf09a93e85e0107a49c51de60e81388d90d6cb375d4cf80d7aa96a496990c524f9150db5e1de15bc5902a154bd05b0ae80e3f566f1fadc01a6ac7cf0f8f126524f8988714fa7e42529ffba2f23eacb26c07d48d0f6940ad603775c56d87bf2bc14075941b2b2d4b00faaf2f57ffcb0102003bbf0d3d95966612ef1965629ca77f1ad36f479c319e65b5b777c7fae4ed5e087dc347184bfd7521db4f9ff7d1312acd8cba44733b95ca62bb6d0881c22a280181ffe3bd81ece8a065bc8447c132ff8f69df1d2042d879bdbc6da21a7b3f30082c491b5ac1f325b8e3960266ca56ec335de25d379498fe80592d0bd72892350c0a3a100bb7993813698c2d02f1ee0e43d6ffc6d8632ee5bf859167f9a0b89e088c03df56c2437f9f0c53d305c5cc7477b5cecba07ccbee7c10cd811e5e1180062fcb415049909cd38a26cd38672e35bd6e46724c094231f6f10efa7f609398094a25fd5b7d86c21ba30b666c1acbb48b7b2fcebab6a1d0f4ed97310228b97c0bd0005f4ea1cd8ddb9fc44ce115847fad482cc75b7c69d695f5c6a3cef26311099388036aec5e6723c14da4320612ee9b86e528e28653d6d16819f34f29e30f007c9dc340dc571f2944979261f643728c2a2206daed4477d92da49230ceeea90b2a7d4c0347d2ffc329176a8fad3c8fb831167d9386f9b9bc15324c941a93e70872aa4689b83190d40162a1c9aaebfc04c8331dccd475c65b8aaa2183e233940ab8d046379fc8156e66d01634866ad9f104504b961f97922c5dad328d1176bb0bf25524cb5d456e6bed5e2b60af02b3bd9bb9088a27db076c2ef61dbe32f5740f387c3a40bfe2e6def7ad2c1af53f8b152876b7a4f475e5c9258a32023d509303aca13d8c3f25d8bb4424a4b8a073dc34daa60fe87dc1a55c14ec0052d013850db2d4d7110f1a750e28e8c573a26f3a9cd20268d1af153321b8cc741cc2024d09a05ebed0f91db4d68197867dcf0f4219604922c308ca45c580da070ac450850665f3c3af117ff1237627eca9f3ca33da97f970014aa0f41681fdfa36303ce50a5f3a89075c1a66ecd5c20959eb7a2a25f4870fd2b5b5cc52ee6c92a7afa6fb0bea8fffcbb67645e65f6ef66fe5692592150850308f8a6d21cb4e043abd153f0dd2e33ad76cf59dd74733c615ebfde4e6e5c3036263e0652ba520959052083b0994a546a4cc8d57356d638f3050b38aa33472b012423cbcaa5e38e1e0ab7f5701ce16e4838e4fd08bec060703bba14163f49467e0518dc242fcd215a9017a5cbed6a58abcbc5fd1948e282b2e25b1d15c42fcebc74d816a54c6f9c98a319a706f").unwrap();
    let tx = deserialize::<Transaction>(&hex[..]);
    assert!(tx.is_ok());
    let tx = tx.unwrap();
    assert_eq!(hex, serialize(&tx));
    assert_eq!(
        "492d60b464924064860b84d2570a8cef5e1e65ef93db9bc9f176ae4255a5a570",
        format!("{:02x}", tx.hash())
    );
}

// Rct type 6
#[test]
fn deserialize_transaction_7() {
    let hex = hex::decode("020002020016ba80129228d00baf30f1079806c227e1014c11b101ee04ad022ffd0205b5012e246611f8a5104a47ce7163ff46f75808d09919f0ed5036d836f9562687478f97d0856f4f74b7020016d1b909928b028b9e069f54d014841eb3119007d5058810db019c085f9c01ab04ca013e13156914c49111229b6f0a3b4e453b581893b1151305f54bdad4a4fc259710bd41f62b69d91300020002287a23db4d703ab323b7a7ebc7ea8d07b264a9e6ee67c6cebb696dd24b3daa5400028878001156e50e15ce34603f410e6749254dc5f56f77df4141f983a8c7939d622c01038e90d13e4f64d78089a0a258267b1baf9c182f03f2724fa30d45d9d9ccbadb020901f4eebc41be2711f90680afadc1044cfb1b622957a9be9fdf383f539c9894d3e0d813ce371ce2605b2cca361b3fab0fd0110c6622250b223ac4dcf6951b0521075c01a6e2b175ac5bb5724e12124f2d4e0cb1b9138de85c86731b6b129a6d016533f287c92e44311bc68939e7ab0626412185b6055da3a08210201ff45fdbfcb2d4f3e47ea99197f96d854740f232fc38dd69acfac920c615fe22c45d6cab3850910c1b426a398fdf04fddeeca20e106afd3d45a2255f9edd3293b8002202cd35666f0ad6fec17e214e9dbd68f6018bfa0c1e7c51e77dd5917332238fe734b136ee7a9c9b34e4d63714d74be28e49e441e5070799adbcae3091626d4cdd8a0e4f6c0ec37f20c2b1f556ccacd9ee6afdf9bfe8a542902a85e2550cf10bc11f0307bc41d7c35c1ee779abb44ed1fb152a2cc8851f4b94808427350ecb681fb04cc6237efa3dd61a50cc2243626130b6dff11609789a138e8b06da581f4a1e3f3b008a845f54062fbf7128d5aa638b7d6ee9ebdb619058d1b410ae71be0f78b6b649aa682afb5195efd4e28190d3f0214614bbad346c6e9f8e0118d2bdc61fbc6b98926689e96f6d68214ea8a8770ca054e10eda21557829265acd08ed488aaaae03b98fe80217af2b1f75754f2046a2f050cca84cedb897ed952c1af013457ebbe519b94761e4341e80284fe0aedbbdf81909ee162635778ef0b0ef5a8e8d887fe1076cccaddee48ff7d4152218d6b039198a4ac0843ee77c02c1820efabd623fcec629c56e8593523f6c4ce9a94e537f7f839d989add3e08126b67b66c0b0a394a52d0e64acd1f68e85e6977ed98b25a3eb8b74b347977dd833de057932fa0c5326402f24d029f32c31646f81305490160ae3c45f21030280b98d25f5915ef0a7276d4efc35ded78a20e91c69a28b8babfbd3dab3912570c253ee0315991db2f2cc06425afdf73b536f5aeff539d0043b4208167a3e4d4ec0848ec59a69ffa1ebd31c1f02dec7ec1a9a582ead31149c1e6f0232ac49baeedd0490c7676e5e7fe69348ccb1e02aab3574d81a04a9a2894407b3fbc0cecf1040d2cb6ebc3bb2bc3bf0ce220d778aad31465ca9935c98abe355e8bc3c8345df40673ce01377dafee610b5cf8cc0313ce1a1fba5c4c64407730706608f281ef0edf7a6cea45a979606b0b2a514e3f12113c9707802f5ec53daec72732b906d23aaf381e4351c270d69e029b0c0bfba967af6f741df9010afc40b483078a486ca2aba8d744879e605dfe0d739fdc10072ae3574359b5fe4c0f6ee5546ad327f60a8aebfd7bf276831148033e8d3ea750081d9af3b11336c6d2649aeebac0c071e24175004eaf6a3295f40e5c4b834d0a3bdfd2798d91d9d50c02db75584d6c81ec5fed6652613140eead05b6b99bb8912ba9b685cec68edc5773aa21de13677f2f92a287983bb83f2aa80c12b4e1e739c7a969e7ee4cdb7e49ab036b45de8443ecd685303fbc1233a2220ef3a114bf5b6b4cf4daa873b39ef84ed8b4ca22d2eafd8497a5b9e8b7394d6f0e2a314428d81b3b42ed71d6305c58c881c5092bbba36d6480eaf238beb1f23c09f5e9c8db5ea50402a6fb03abb170f11f8122f54524df84e726f38ad44a63f707f1dd0ac98b5303dba6a17e5772a942b69b6aa728cf103c0c857ceb7266d3a10a390d804f04cb53593b276ae8139b958c86a9363c43e488daa0d85fb2d7776001a0b4ce86519564012311164a3b105cebc881e1886787c8a465d393d9343cde0d43112535933c95669e468be57a5ba28bfd8f8db5a8ee5b5e147e5eb86bca7904f517b6c2b8baa21b89b2b6bd2e2ccc6a2e077507edbc92906b1566473adb48020d5bf0597c005437395f65f236e6de547078eb10ac3c8b7ef2cf56f8d38a380bf13ff26e824d02aa3802fc4a5caacc8409662c7ef0fe462bf375eba3885f180b60fdc24412673dc782390b4da0a6936cd2a604186b61c4161ae174629614be0daedc874c4849fbb8c0e1eeebd01327b32c143bce1e2545b07da7e45d7dfed90667098ed460eaf826254e2b33721856e055ec3fd547fa7fddfff77fc55b46070e56e5e70a186da6e83376fc126d6a6ea0d411a7cddfe646406dd5e947b4f8bf09f82e4a2feff8559dd4561f274248217cd4bd7c368fb8031762c0337ad52dc80ab4f4d18f2dc89dc6b138b305b71f77f2edaa943025a61797da03a8971aa1ef0ad0039c040ba8f6bf390dc0f91d2336688ce2686dfaa77adce6f0b8adc97b06037a4e5f86be0046417f444b77a9d3a0e9f24585cc4d1d88b0679d5cf7be841602dd10b2411edb8c07c1068afcb7ebb385ca866690180c889c912ddb9f6766d7027c558dca4a310ed00914e22cdb7bd42a869db94c64aa8fa7ea54d480de2b700f219bcd7e16815c64a03e0ce105879ea56df857bcd7100d40c17e6d67db537107bda9c7c721209e0c9dfd42fd958f8ec09373d2e445ae1b82184f0a80995e7b0aa118d97fd7da563466c4cdaa43c54a8896a9f17552a5a8054eca2a8b802623087fc443d975ed385389eb219130798cfcecc60fbaa905240e1dffe479df834606864fe1b618656a562c84fba2c466235fcffa73f351359ce85fc580dc83c1230eec6ce94dd5fddba4cf9538f73309f8c5f3fe21622237de3481dc0fbf68b0670020a5c3e1e7feb97418b6355daea79a25e2f074b4d31791257f10ed55a5c93a07722d7d3c1aaa9b3ee4c6cbb6e3ab1cf00f592a8639d3100bc8a2edc58d24630b4412764984a6ab0df12cb4953c981f1a31902d038ac841400adb6e32066e780937857caa905c9b80b2bea832f8e88e158c81974d635fc95b076c73771eb01b05aa3a1140561cfa1c4353435a2b06f96aad65db1f4c95ac1c09f8d43717afa90a9c0bac968a9fa4b371b5dd6d204eeb5d267f5e58330faa19b73f67d1ba32860b4cb07691da4ee599f5f28369b8c216330f3ad9ba4f54c1eee373af1786946f09f426dbfcb9af9752f0298fd30d2cf2a02d54fa2beaa6f644377c0f090793b709c67f6e283267f04450f58b111c206418dbd86a53019db18d45b439ac49c5f4038251a3dceaebdd79938efdaac021daaef4f0b2c08f3cef6782696d9b5810520e1baba3784399e4eb5371d95bbaec4fafc4a43bc6e8c7659805a9ead08953d90ccf5d6a6d693e0dfe54661f8976b7e8744c6b4f77c4d9bdddb82783fe73c24f04930d1775fa1cd98e53ffe984cfb27718f91f7ca796a0d3a6444ef316fba6d206ad060b76e1f167183ae5150c0816907136933ab6065fe44da3ed77784c38b605b66ea00837db4893f248a612aceb78ca9c587b7f4006c1aea966c651b310650e36eab3ed01957a4c11a5db287867425befdba3c2e4e03351ca56ca5c683e000244b6af0792d7137706fb9596794badad34a3bb90bf725a0bb728e099a4dd660a58214cb30e6f42517c40a8b6ded468522b7e4f270195f69be222069b7445df037420961b89ba8afc2e88f2f51aeab3d48bf06b2ecb37d00f8b3fd5fffcfb9207ecc78680d5797bdeb807320489410f8462a562c8bd116ef495c62ed80d17050b680dc8fff13e8ee98d10f0ba87adc0f16a084be4b20af592a88d4eebbb4f1a0c8ce7ba487fdc07c079fdab71fb7091a8f1bbaeeb723117f98aff8afaeb363203283a36b3609abd4de99adfc634cb5e1f1e0511eb76c8f827cda5fe0de74b17047ac306efe2ff05553e0bb8873c8d5dbedaf2d65afc42606e21a397307b188d0b88bd35faf861f8cf4831e8a6ee24ffbd978d6b501316a60833afecd08ebd400f154ab90467df689747653b4dfc236bc982a87e819d3e5c403a96a675f8a789066761a1f7baaaa15034e08b13b5c593410320296b1cd1a850ab1bb01a97021a02ab00078e2f0c64d670c88903828f50b4bfa7d50c680263526d498a3dc8801a0e8e7e71870382048a7e13ec233bb27a27840bf90a70e417cf18649ab0c861b806c2a388e6775a3df728fee61311c287dabde00f1fa8b4362f8edb3f5f9ed14708503e9b417b276a2d86dd7d488de2215be5b0ba317289f140b1969ad4118daf0ea5c35ffcc4c9f2b6a4da02938cb8c85b8114956df5faf1579c95ac407f62d60dbf8449823f5648835e8c2729a5b9590f36587e293b0618ed24a2e6631f0abc00f6760ef4ba31653e0c117c024de8e2ee3dcd33f854441bd0c52d49c333c54503be89e9b2fd2a06158ce9ff6a6f2fe42ea8c21e31ab257a29320557e3d9c40a0321debba9a9bf4a15fbe18f0d78fea101e6fe621b119537cbc708a39291912601aea1ae983192014cfc1a669bef5b83d79eced98cc6313a983c06f6a80e77a2031244c80935f0c4b466988feda707d99ddb10839962d68eaed7108e0c46ee7d0f3a55dc2f29988c01f93bb57c6754e31c6127b53a347a2572f4c2de283ba12c085d5087c91f2109d8859e359bb0a104b4c95c7713cf621acb0eacdb3b3239d10797309e8b9d714a86a8eeb4863dd3633dfbbe5d2a18351d21ffd0e40d555d7300aafd31831253dae56ec6f3ffbcdb5990137b24cd26f161a7c949ab89d7f64506e4939707ec221341ba2e22f20ce6069cfc43766cbfdd2d5c2146ba483ff9150c0fbdc4c3c8ef6a1e98a380f46586cfc63e53bcf75fe29db3d28bf035deeeb10fd5b350f2b407a5614418e8924a7fff978cac2ac12d143d08aaca6e861555ed0142f0ca50e52da37be737718879f3cf4c10b95d619c7b16b4986179587807d101fe85ce9df492f225f6f01198e33eddf0160be68b331f0fea1e6c716caeb4950659597a4e480b7a5c3aba9484982e6cb9fe7ea16e62ccfe72573b2ae89aa394040d10125b3d5a3ea11ecdb8b27b3639223f1c71649902e6f46a926a805164ae0223d3a879cd005f7fd7e89a525c3288bedf60c14b233441ebb0f8d531dd7da00e9340e4753c645f2f1913dc09eddd5837033536bdcc5ec07c9a6acb9bade69700608e75ab605e676b1338cf0c78179509e940c54accbaad689b737d84e8d3eb0173dd092484b8b1ff2557f7b7175bf1c4a1ed04befffe52dc612efd6ba6620b02c085a72be03b170fbfe3905aa29e31c766e08d470287e1836bdc998c4e1b4c0bc0263ee80787286c40e7c020ab27337ad1b00ff70f00b6e083e736b671f1fc0731e525a36a55acc27a50b8b9be89a868ed8fbbfa049b02ceccf419cbb0f3650f1e7f90fd21ef068323434e9a1b87b903ec5ab4fdaac75bceabde396e74906e056d2ee5457ed0b2e52ba9f237577d236b14934c80ab20c740dc5dabd01b8d54c4be6db5ce740c64b49d4cf1d08a9a6e2765a32433081d3dd3f1731ac79186669b").unwrap();
    let tx = deserialize::<Transaction>(&hex[..]);
    assert!(tx.is_ok());
    let tx = tx.unwrap();
    assert_eq!(hex, serialize(&tx));
    assert_eq!(
        "259bea13d5fdd1bf59346991240c7aed573cbe03524bc390e1f0d4618f326dd0",
        format!("{:02x}", tx.hash())
    );
}

// Rct type 7
#[test]
fn deserialize_transaction_8() {
    let hex = hex::decode("020001020016c1d529e2811cace1059fbb09f0c201ee2b8a37ac0dcd08b8049f0fac08b00ec112e0049112b702b6031c8e05b905c807c7748841620400d9c50e1b428e910e72fbd9d6e844734ba93f0734d0601cc8b902000262e143826214fcfa2ca6695867bff38533b409718c617ca8679d2fe7f44df3ed0002520ef34e0856a9b08051ed0089b9886c0107b5ab5d51586b4a5d24610c7c14472c01db02ac0b56e55266a1cf8e0ff9af85b9782eba3f67641ea4a4af5235ab9a9b94020901c65b2f435f46b64507e0df88850239975fbe78ae163f16c152ea5f3a743fa39cdccd72d233190ff2bd69a31243eeaa0985eb0ccea890301fedf29870d1fde3f575d8aa201e39a92c31caf59ebed557ba3975211eda3517ae05f969f6df550166014f48b4dcfefa790fd99ea44eb33db5649316a26c282e46e47a61698cc67a5cf69b403fbc1a1908be45315586686d3bd917afb46cf20aac26129d733ff917dfb569f12fcc3ae1a1bb6dbc131955a4bff035e19da5cbdf6efeaa2877d6e5320b600d3bab7677ff4f550db2dad89633fc401b5b0a474545fecafa407d36cb09945a85129663f569d6427c985a720adc7b0590603f686d1fa724a2018be88109da5015205d059366a1be91e0dc98c74b3b67b3b771686733dcecf121ad562707079e34c48929fd530c65b15b977d800d3bd923a510743dd13203b9f9285bea43986a464d2f3da325fbf4058e2ccf7c69e7340c6fb2cc0c6026d0b0604a5c8a3829ca898445374590a9a69cee77bab1d9654864ce8ce389e00dc6e16aacc1895387f4e068cb15b8dfb08f71cb89ead95940e7da66793c8176d92a9e8652d7e3cb7cc7a12b672fd60cf4364fd73aa5efd61773b8e85130b74d6ed59b10ffec0d2525b4cf7af5520087215e485273dc9cfbafca4ab3a00d374278e8c2e2c031f50c38ce8eadcf3c259e37011105f070a7b4659ef096d547f026c5cbe907cd5a008e58076a62f796fcc2250d7c24493a988340284547f38b277fac83bdb91b94ba3637a6456006dd83c601df59e91212a4021a3e5a85b786080d11f3996cdd1b7542bb4f5019ff5cb0ff68832e2370298990a5c892181fc46de2e1262768c31c2d7381016fab0d59ffd0a85608e21c66905674cbed1becc528558e29bc8c36dd6eda29444b9e5b643afb1266c0be1782cc5fab820451bc7f8596f08ed14101ff298eeb34b100a6de0ebb7c1ee0abffce09259b66851b9bd88c422201cdf40848ec99fb2843cad3a4a020c050fb3a5a48907ab0a381fe87fb221390ba5f3d0331002627597e15feeb2ce02cc6c88ea94fb7dd572e7ba3faac0d7087ce60f7d3452836950c053406e8902d50aa36ee08d6522d5c202e4bbe72e06d8af3a77d6bcfcc230300b94eecd4c8b4a2f8aee80a9c6509fc7c7ff975daa0e827a94f49f1a35143f90dcb84ec75d026dd576ae4ad09da18318167dbacd6ab1a0013aa3e0cfcd3510a038a5347434199a4cb33ad8ede31a4512d620c52e6811259365fec5201b0417f0377ad8408b4b6fb9e2275a19e42835f410780c6e1d8af83d149c3ca003a02050c2f54465b333552b9158c62451b466cb19bcdd1e1bef55058d70c66cb2802d70010e4db1624e0378b8d1c7aff52b3178a3f7b73828ea7d590181fcf9de4708209f73d013cf06370a32139d27bda4b156df4b4b3f6575f9e4d574cc0081d8d350771828eff799d59ddb347f6ee5b6695bd2aa51ed83269079105cc7157b2fa270862fb049c179c03af63e903204fb248e135a0b34a7fe9e964dfef1d8399b92705d9684f0ac946e6b40f20004a9b2b74678f141f44121bee3ced4f4d231ff6f90591017c93a49d1acc497c76e9278b8b4068a86ef63c937ceec9cf9b60e8d79d026bca4346ac2433b68f33fcdaaf4f3abfbf53e6485f7a1d2efcef2e11c814f70a77a1e5830d543eb73855c90943f2aaec50020122a920bb32ce21fc05f33b28022e52fd8e21eda4567f807e966c56b3bf63ddc355db854f49f69b2e39c8997d0073744b54aee597c40b24ee6dbb0d0d6b4e35cf3631c667bfb488cb2858a6400fcf3ee0c11adcea7e8c1ebb0c01a4d9ea7b1c836a1503b9448bb0439f8531410deb70d1e38eff3bfaacd8c753eee3a7f92d81f85d33f5ad9418db03536a1a040b5a5a088b8eae08fc39765abb6bc8bc61751b9cf460f583817e635c4044a2a10016da36c683a3e5e451cad2b4c4a857c81ae7ac94fa055c5e88c02a190c8c9e08932fda533a5db0508370059ee624873bc2e752c442fda63af670d0e1fc5abd0a53575683680eb22bcb7b5ddba5325daa40ee180ec5aa6748d6e04e27fd4237017a143d85c26f201fd2bfddde748646d5e518f3d3a2ba30b4031d878e8a32b3018569cf4d93d06e9175191ef2639fdbb1586512e7ee83a0a4870e56bc910f8f069c32b6ea3ebb6b9c0b90bd5f312e7f9d6eea296a22fd30f294487ce5502d9509b836383e85377fa26a4194fa8ea5d886f85c3716e673fedfed454f0e4c2c7a4c910d281f2a52831c68ec200b3d16ae5d3b1289fe5a6e991e6606d4c967633431").unwrap();
    let tx = deserialize::<Transaction>(&hex[..]);
    assert!(tx.is_ok());
    let tx = tx.unwrap();
    assert_eq!(hex, serialize(&tx));
    assert_eq!(
        "339b3f93c3c58f3991538b38240f11cb1cc8f6512c016fc87d83354370238eaa",
        format!("{:02x}", tx.hash())
    );
}

// Rct type 8
#[test]
fn deserialize_transaction_9() {
    let hex = hex::decode("020002020016d7e016eccf1ace9c2fcac802a7961bc914c6178f06bd05c1044cd4018301c30793016b44110f6e98045d87cb7e5f9f4e34d2bb529aaa536db89cbe179c4bfd50307874596e2131f962c7020016e9a008bced68f39f02aac101ceee02bfd904af0f97099e9301e836c113d61332de03e20ad30bd90437c90a93079504d50204900d7401125685c2de1448a89e3f658cbe32a2cf82858ef0427d5438260a23020002b998fda8223d3db2d4866cce7c0d179283231b5db3177ce06a44a285e91ba75e0002bd0f4383ff7940d0b37bb648e9418469ddb34bafe9862669f66699055b7b6c572c014fb7c0d75db8b2b1cf212f592d789e520538b6787861a29577c90f7e8dc838fd02090106483074923dd85c0890f98d666da738fd2c39427c904e50ce2889f37945dcdacf5bf311044536dc6cc2d521724fa5e7323bfec767f4491a73391327b0c4f3d63fa09ef6cd119bd6c05ad3f449eaf2743b76be93592b166972b5bb8dc801d9aa839337e5d0d305326ca89f2323ed2115ffb4157ed399ed0f82211e5b3f6ddd26e0b4b555907b5ef90306125805df64c2d5fa2d29fca8af22c95ea0581896fbbeb2d9a1150fe3acaee6e71aac7f973190b8675e7111c6ce30a9ecb83c4697bc907f8ce4a7bbf26bb05f0cf123e3925b2ab27c2ae77ef83726a536096aba0e98835c3577969a7d5d223e676ee7038e8635c9584f5d7ce4ccc7614a6a60ca04377952413342232957a8347380fe9890e7607dd81a94243bfd994ca517986003074fc24d64422930550907b127e5c22269f09eccfc4cae04400ed8cca03ce4bfa8d14faa5d0eebc482cd54a933ad052fdb0fb7c4ee435c752650b87f2acfbe0fee0a31c011b25113b309f2e7fdd06c5a3e1cad7f86d4bbb213907e621cd10e8677faa63a64e271781a143d535d5822552893dfc86cd26b46c3a79c46ed1b1670ca99cbfefc993cc915e9d214e7d5a3bcb33176c45ec10c952957d06586c0e99a3b09165825044900ad0b045cd86aa185d70914f183e91b4acf9ece7506a761be1f661cae801d1637d73baeb21367d7173bf157f01bbd13132af957890a0e01488f07cb01541cd6a61a53e0a78266e55ff427956154859acf9a1dd9ea3a203dcf8582cf49b96e9f6d633a7f89f2f8494bd32979a12d3a115e9bacf9d1dda93d521d5ce9a47b5b82406e0fc3f2f72189b473196a0cdc5c836ee7df3e691dfd94193259662dc311d0d29e10434322fa20d3d25d4206f768c631528a8b32502f02e53e3d4b2743ce5c78d8ae67eed921013fa1c53208b859c98ff31baa87746e06ded5f9bec09193cc2d06af8344128b9a40dfe73d957978824770a28c94bd4d67498f44219076ae8c2ef0f258d189b0818f0d24a115041c864df8caa793356145a838225ce8a86d4340adbfa51d45cd0b21fcf494407ca5284e06025dc30f651cfa9508281ded42a1643af2fecfdd76c3d2c9fa2247a579642aaac863ff4168fd9c9e05f6d0cb2a6a4b671d266b8d667844373c489bfc02df2338166a94941d473b5405939d75e2affd32b038e94487d8fa09f371ef11bdbf59c05e6ac110cbe25ff50940bf5a340677021d8d480a4921738649719856cac06bff8ee3db9bf78994d40ec6f956a64b2ccc2726118b738760b98f4e4bd2f832deb68316dc98e73955780e496adb078c4b6a4fcd0bd208181e9c0fcfbff61d14303b0a2be133b91321cc058668571fc8c91ca49750733d47ab00e32706b25b847ed81f5944da8a072b7e0e66c64ab18febda32eb03f9e978a808e847ec72295164a958cb7c29a4b5ba5c0fcde0ae34a5f6e2af5d35281e32989c776320fe8ec7dda35179c480d0caaa2c0fa245334d5aa5e0e9e4ab9a168210f3e268669c8c9be5e088093746baa49fae0d90cf5dc44a1c892d9918555710fcf397183910a4f02b63b4eb0f49b13bdac60a236271a8e4c23e55459870032b9ab34dc85fcdcd99475a473f308c9cf92e3d06fa2221956b9bee0f51649b061845b9a7fa42a56ee54f187632e0da6005a8a30e81f7da111c40b15fa9eeda03e58edf4f9f0fda4ecbcd2189d4aa36209c43b001f095312fcff169ad3608834ffd47cd15d61255cf1b8748d7035297f092dc3d08d72ffa697cd4cd3bdbe38ddc4527905136425f1ad87d2e1635fd97c1350d06071fe09da760a65be0139a886618736e7ddd637ebb304742e75f99a35d353abf08f16a75705c3496fa1086243c249e8d2fa0088518c7472dd54d61c9f6ca8ebc0bf4cda8a40e45b56e0e754dcaf4ff9072ccd3dea7dedc6eac84148d85e756bb0685ddb8c30d88a599fa3d44f7e7f15b0805a43ce147a9c4286470a874f041790c153d31740b5de6c8da6ad5314cd247630f99ce46fbcc90307b8e36c5c38cf30bd42e781b4bae7146e15a6c93273656aab6b76389114608ce5757dcd7a59f860d69e6e8bfb2248c4c2bf7d3705c9e2db434a59b5398c6031872072be96d3c7a300bb941ef9695809b64ae02e7aa229182542a5e799556462da035c2bbec0fe40b1f092010b46f27a82124f93525462f8443a30a9c4322a31990d6688b6a53c70be05b7ea23c5682aa64d58e867b8943ffc9337d2dce6d1e2b8ee02f1d852dcd07827e8b467052f1c524f21d865d483172e4c056a2e196e80c224fd295d6a8d60660b4d8733fef08fc8256c7575dc25a833f21ed92ca87f5c84df40066796aae01cc5e448a4ead2a5a1aeb93955c95a2b492afe6dd5bdf897d2b2552cba4b941002c9460d18ffdee5b343df06ee42aea4bb06712384e268dfa7c75df65da7438011bbeff80a6005ff6062e448abeaf0d5f0a355cccdab21cbd86e46619a6098604186292295b44c4c6d346310ea3fe670a415e7b086171d9f4c66eede43d8f040dc975696ed88557f26032dc7af73c5ba7e3f369322488693891d4b7d041cbcc06783a16fa7df1f5324ed918d68ccc8d6ab47a3e5f6ad92ff2fc84fc2b1b5ba9086bb7242ecbb9e4bce483c253254260f53850679d5d578a31ce1d14d339627404d370170781af264b51ea099c277bdc9be2749f465bdc760702673209ac79d402c83089500beea45a7d19456208752ec6bbdd2b3db0699338c7a63867fb70250f2578c92d861dd4053990c9fc3b6a77ab0966075d700c6d2761057311596d3b0f629daec8e447dc1f91623bf95f29faa1d2ee63e36d81ecab0bd453b86bab2701010861b07c7163ad4cda1b04cd9b65ec065eb7700cf1aa7ec01995f1ca67ca09e5ed9b931b844e5d4039c88f49c78ccc1a95316fe9f97e1ca097e1ddc72b540bb237c35b3e07744b5721b0177550346edccbfa9a1cd08e3594b3a778a2b9bd0aeacbd37fd3f07cd612d85206e9f1ea9ff784348bf9b53e8a99629353f9ece002307e87ce356e849765ba44b339bc8fa2a3e3afdf8686f3458d01c31b1c231103a7fabb9432e7e62b7c08f1d6ec10df62a5dd392568e22ae207675e0953fdbf0e1cd2047b8e8b11d56ec5f5120522081989b4285b21d0e9ad54547ff991a0180fc4eb027d5cbfa5f8639118faeddd452abf6c60d963edfcc438536706d616c05475734952de683a3c989e5d6134c59f82082ec6d563f7812e29c93d877daeb24ee1a1d6f39ca5b937e24560d7142de8a8fd730923dc03002f7dbb4557a77a89ff").unwrap();
    let tx = deserialize::<Transaction>(&hex[..]);
    assert!(tx.is_ok());
    let tx = tx.unwrap();
    assert_eq!(hex, serialize(&tx));
    assert_eq!(
        "799430088b982acc391c12b23eae64f7dff77942982a8aedeb8efdbc82824edf",
        format!("{:02x}", tx.hash())
    );
}

#[test]
fn deserialize_transaction_11() {
    let hex = hex::decode("02de8ba20101ffa28ba2010190c6afb1be11026cb8ab2153b04c9b955e444b026c38b3dab0b033a8607c66aa59e45b305866013e01eef7d65dcbe97e40bc1e79d0b810b662981a2f402005e07bc61340abb3813d9b021b6d696e65786d722e636f6d2901130000000003000000000000000000").unwrap();
    let tx = deserialize::<Transaction>(&hex[..]);
    assert!(tx.is_ok());
    let tx = tx.unwrap();
    assert_eq!(hex, serialize(&tx));
    assert_eq!(
        "d0108dac8ad68ae30d0620ae5c898c9be148639e77f2d94993978ffadabd6586",
        format!("{:02x}", tx.hash())
    );

    println!("{:#?}", tx);

    let extra = hex::decode("3e01eef7d65dcbe97e40bc1e79d0b810b662981a2f402005e07bc61340abb3813d9b021b6d696e65786d722e636f6d29011300000000030000000000000000").unwrap();
    let key =
        PublicKey::from_str("6cb8ab2153b04c9b955e444b026c38b3dab0b033a8607c66aa59e45b30586601")
            .expect("correct pubkey");
    assert_eq!(
        TransactionPrefix {
            version: VarInt(2),
            unlock_time: VarInt(2655710),
            inputs: vec![TxIn::Gen {
                height: VarInt(2655650),
            }],
            outputs: vec![TxOut {
                amount: VarInt(600862090000),
                target: TxOutTarget::ToKey { key },
            }],
            extra: deserialize::<ExtraField>(&extra[..]).unwrap(),
        },
        *tx.prefix()
    );
}
